<!DOCTYPE html>
<html lang="tr" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>İnteraktif Rapor: Mikroalg ile Hava Kalitesi Çözümleri</title>
    <!-- Seçilen Palet: Sakin Uyum (Sıcak kirli beyaz, yumuşak yeşil, kumlu bej) -->
    <!-- Uygulama Yapısı Planı: SPA, kullanıcıyı temel sorundan (afet bölgesindeki hava kirliliği) çözüme (mikroalgler) ve bunun daha geniş etkilerine yönlendiren tematik, doğrusal olmayan bir yapı kullanır. Yüksek seviyeli bir girişle başlar, ardından teknoloji karşılaştırmasına (interaktif FBR grafiği) dalar, çeşitli uygulamaları (başka bir grafik içeren sekmeli görünüm) keşfeder ve son olarak katma değer yönlerini (döngüsel ekonomi diyagramı, STEM proje kartları) ve gelecek görünümünü kapsar. Bu yapı, raporun bölümlerinin basit bir kopyası yerine kullanıcı keşfini ve anlamasını kolaylaştırmak için tasarlanmıştır, yoğun bir incelemeyi ilgi çekici bir anlatıya dönüştürür. Yeni bir "Canlı Sensör Verileri" bölümü, Firebase Firestore'dan gerçek zamanlı sensör verilerini okumak ve görüntülemek için eklenmiştir; şimdi MQ135 (hava kalitesi), Işık, Sıcaklık ve Nem sensörlerini içerir ve pH'ı değiştirir. Ayrıca, sensör verilerini grafiksel olarak görselleştirme ve CSV olarak dışa aktarma özellikleri eklenmiştir. -->
    <!-- Görselleştirme ve İçerik Seçimleri: FBR'ler: Amaç=Karşılaştır -> Görselleştirme=Çubuk Grafik (Chart.js) -> Etkileşim=Grafik/metni güncellemek için düğmeler. Gerekçe=İnteraktif karşılaştırma, statik bir tablodan daha iyidir. Mobil Sistemler: Amaç=Karşılaştır -> Görselleştirme=Çubuk Grafik (Chart.js). Gerekçe=Göreceli performansı görselleştirir. Döngüsel Ekonomi: Amaç=Organize Et/Açıkla -> Görselleştirme=HTML/CSS Diyagramı. Gerekçe=Karmaşık bir süreci görsel olarak basitleştirir. STEM Projeleri: Amaç=Bilgilendir/Organize Et -> Görselleştirme=İnteraktif Kartlar. Gerekçe=Modern, temiz bir örnek sunumu. Canlı Sensör Verileri: Amaç=Bilgilendir/İzle -> Görselleştirme=Dinamik metin geri bildirimi içeren HTML/JS sayısal ekran ve Chart.js ile çizelgeler, Firebase Firestore'dan veri çekme (MQ135, Işık, Sıcaklık, Nem). Gerekçe=Öğrenme için gerçek zamanlı veri etkileşimi. Tüm seçimler SVG/Mermaid kullanımından kaçınır, çizelgeler için Canvas ve diyagramlar için yapılandırılmış HTML/CSS kullanır. -->
    <!-- ONAYLAMA: SVG grafikleri kullanılmamıştır. Mermaid JS kullanılmamıştır. -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Open Sans', sans-serif;
            background-color: #F8F7F4;
            color: #333D29;
        }
        h1, h2, h3, h4, .font-heading {
            font-family: 'Montserrat', sans-serif;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px; /* Sabit yükseklik, duyarlı hale getirmek için medya sorguları kullanılabilir */
            max-height: 400px; /* Maksimum yükseklik */
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px; /* Daha büyük ekranlarda biraz daha yüksek */
            }
        }
        .active-nav {
            color: #656D4A;
            font-weight: bold;
            border-bottom: 2px solid #656D4A;
        }
        .inactive-nav {
            color: #A2B29F;
        }
        .active-btn {
            background-color: #656D4A;
            color: #F8F7F4;
        }
        .inactive-btn {
            background-color: #A2B29F;
            color: #F8F7F4;
        }
        .message-box {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #333D29;
            color: #F8F7F4;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            text-align: center;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            pointer-events: none;
        }
        .message-box.show {
            opacity: 1;
            pointer-events: auto;
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-[#F8F7F4]/80 backdrop-blur-md sticky top-0 z-50 shadow-sm">
        <nav class="container mx-auto px-6 py-3">
            <div class="flex justify-between items-center">
                <a href="#hero" class="text-xl font-bold font-heading text-[#656D4A] flex items-center">
                    <img src="https://placehold.co/40x40/E6EBE0/333D29?text=Logo" onerror="this.onerror=null; this.src='logo111.png'" alt="BioAlg Logosu" class="h-8 md:h-10 w-auto mr-2 inline-block align-middle">
                    BioAlg Çözümleri
                </a>
                <div class="hidden md:flex space-x-8">
                    <a href="#problem" class="inactive-nav hover:text-[#656D4A] transition-colors">Sorun ve Çözüm</a>
                    <a href="#technology" class="inactive-nav hover:text-[#656D4A] transition-colors">Teknolojiler</a>
                    <a href="#applications" class="inactive-nav hover:text-[#656D4A] transition-colors">Uygulamalar</a>
                    <a href="#value" class="inactive-nav hover:text-[#656D4A] transition-colors">Katma Değer</a>
                    <a href="#sensors" class="inactive-nav hover:text-[#656D4A] transition-colors">Sensör Verileri</a>
                    <a href="#future" class="inactive-nav hover:text-[#656D4A] transition-colors">Gelecek</a>
                </div>
            </div>
        </nav>
    </header>

    <main>
        <section id="hero" class="py-20 md:py-32 bg-[#E6EBE0]">
            <div class="container mx-auto px-6 text-center">
                <h1 class="text-4xl md:text-6xl font-bold font-heading text-[#333D29] mb-4">Geleceğin Nefesi: Mikroalgler</h1>
                <p class="text-lg md:text-xl text-[#656D4A] max-w-3xl mx-auto">
                    Afet bölgelerindeki hava kirliliğine karşı doğadan ilham alan, sürdürülebilir ve yenilikçi çözümleri keşfedin. Mikroalglerin karbondioksiti nasıl yakaladığını ve yaşam alanlarımızı nasıl arındırdığını interaktif olarak inceleyin.
                </p>
            </div>
        </section>

        <section id="problem" class="py-16 md:py-24">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold font-heading text-[#333D29]">Sorun: Görünmez Tehlike ve Güçlü Çözüm</h2>
                    <p class="mt-4 text-lg text-[#656D4A] max-w-3xl mx-auto">
                        Afetler sonrası ortaya çıkan toz, partikül madde ve sera gazları, halk sağlığını tehdit eder. Geleneksel yöntemler yetersiz kalırken, doğanın en verimli fotosentez makineleri olan mikroalgler, bu soruna umut vadeden bir çözüm sunuyor.
                    </p>
                </div>
                <div class="grid md:grid-cols-2 gap-8 items-center">
                    <div class="bg-white p-8 rounded-lg shadow-lg border border-gray-200">
                        <h3 class="text-2xl font-bold font-heading text-[#A2B29F] mb-3">Geleneksel Yöntemler</h3>
                        <p class="text-[#656D4A]">Genellikle reaktif (kirlilik oluştuktan sonra müdahale eden), enerji yoğun ve sadece partikül filtrelemeye odaklıdır. Karbon yakalama veya oksijen üretme yetenekleri yoktur.</p>
                    </div>
                    <div class="bg-[#B6AD90] p-8 rounded-lg shadow-lg text-white">
                        <h3 class="text-2xl font-bold font-heading text-white mb-3">Mikroalg Yaklaşımı</h3>
                        <p>Karasal bitkilerden <span class="font-bold text-2xl">10-50 kat</span> daha verimli CO₂ yakalama kapasitesine sahiptir. Hem havayı temizler, hem oksijen üretir, hem de değerli biyokütle oluşturur.</p>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="technology" class="py-16 md:py-24 bg-[#E6EBE0]">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold font-heading text-[#333D29]">Teknolojiyi Keşfedin: Fotobiyoreaktör (FBR) Sistemleri</h2>
                    <p class="mt-4 text-lg text-[#656D4A] max-w-3xl mx-auto">
                        Mikroalgleri yetiştirmek ve verimliliklerini en üst düzeye çıkarmak için farklı teknolojiler kullanılır. Aşağıdaki butonlara tıklayarak temel FBR tasarımlarını, özelliklerini ve CO₂ yakalama verimliliklerini karşılaştırın.
                    </p>
                </div>
                <div class="text-center mb-8 space-x-2 space-y-2">
                    <button id="btn-pbr-1" class="pbr-btn active-btn px-4 py-2 rounded-md font-semibold transition-colors">Açık Havuzlar</button>
                    <button id="btn-pbr-2" class="pbr-btn inactive-btn px-4 py-2 rounded-md font-semibold transition-colors">Tübüler FBR</button>
                    <button id="btn-pbr-3" class="pbr-btn inactive-btn px-4 py-2 rounded-md font-semibold transition-colors">Düz Panel FBR</button>
                    <button id="btn-pbr-4" class="pbr-btn inactive-btn px-4 py-2 rounded-md font-semibold transition-colors">Kabarcık Kolon FBR</button>
                </div>
                <div class="grid md:grid-cols-2 gap-8 items-center">
                    <div id="pbr-info-card" class="bg-white p-8 rounded-lg shadow-lg transition-opacity duration-500 border border-gray-200">
                        <h3 id="pbr-title" class="text-2xl font-bold font-heading mb-4 text-[#333D29]">Açık Havuzlar</h3>
                        <div id="pbr-description" class="text-[#656D4A]">
                            <p class="mb-2"><strong class="text-[#656D4A]">Avantajları:</strong> Düşük kurulum maliyeti, büyük ölçekli endüstriyel büyüme için uygun.</p><p><strong class="text-[#656D4A]">Dezavantajları:</strong> Geniş alan gereksinimi, dengesiz kültür koşulları, kirlilik riski.</p>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="pbrChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <section id="applications" class="py-16 md:py-24">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold font-heading text-[#333D29]">Geniş Uygulama Alanları</h2>
                    <p class="mt-4 text-lg text-[#656D4A] max-w-3xl mx-auto">
                        Mikroalg teknolojisi, endüstriyel bacalardan evimizdeki havaya kadar çok çeşitli alanlarda devrim yaratma potansiyeline sahiptir. Özellikle taşınabilir sistemler, afet bölgelerinde hızlı ve etkili çözümler sunar.
                    </p>
                </div>
                <div class="grid md:grid-cols-2 gap-8 items-start">
                    <div class="space-y-6">
                         <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200">
                            <h3 class="text-xl font-bold font-heading mb-2 text-[#333D29]">Endüstriyel Ölçek</h3>
                            <p class="text-[#656D4A]">Enerji santralleri ve fabrikaların baca gazlarından CO₂'yi yakalayarak hem çevresel etkiyi azaltır hem de değerli biyokütle üretir.</p>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200">
                            <h3 class="text-xl font-bold font-heading mb-2 text-[#333D29]">İç Mekan Hava Kalitesi</h3>
                            <p class="text-[#656D4A]">Ev ve ofislerde CO₂ seviyelerini düşürür, oksijen üretir ve estetik bir "biyofilik" tasarım öğesi olarak insan psikolojisini olumlu etkiler.</p>
                        </div>
                         <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200">
                            <h3 class="text-xl font-bold font-heading mb-2 text-[#333D29]">Mobil ve Afet Çözümleri</h3>
                            <p class="text-[#656D4A]">BIQ-Alg 0CO2 gibi taşınabilir, modüler ve enerji verimli sistemler, afet sonrası geçici barınaklarda ve kriz bölgelerinde hızla devreye alınabilir.</p>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200">
                         <h3 class="text-xl text-center font-bold font-heading mb-4 text-[#333D29]">Taşınabilir Sistemlerin Performansı</h3>
                         <div class="chart-container h-96">
                            <canvas id="mobileSystemsChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="value" class="py-16 md:py-24 bg-[#E6EBE0]">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold font-heading text-[#333D29]">Teknolojinin Ötesi: Katma Değer</h2>
                    <p class="mt-4 text-lg text-[#656D4A] max-w-3xl mx-auto">
                        Mikroalg sistemleri sadece havayı temizlemekle kalmaz; döngüsel ekonomi ve eğitim alanlarında da önemli faydalar sağlar.
                    </p>
                </div>
                <div class="grid md:grid-cols-2 gap-12">
                    <div>
                        <h3 class="text-2xl font-bold font-heading mb-6 text-center text-[#333D29]">Döngüsel Ekonomi: Atıktan Değere</h3>
                        <div class="flex flex-col md:flex-row items-center justify-center space-y-4 md:space-y-0 md:space-x-4">
                            <div class="text-center p-4 bg-white rounded-lg shadow">
                                <p class="font-bold text-lg font-heading text-[#656D4A]">GİRDİ</p>
                                <p class="text-[#A2B29F]">Atmosferik CO₂</p>
                                <p class="text-[#A2B29F]">Atık Su Besinleri</p>
                            </div>
                            <div class="text-2xl font-bold text-[#656D4A] transform md:-rotate-0 rotate-90">&rarr;</div>
                             <div class="text-center p-4 bg-[#B6AD90] rounded-lg shadow text-white">
                                <p class="font-bold text-lg font-heading">SÜREÇ</p>
                                <p>Mikroalg Fotosentezi</p>
                            </div>
                            <div class="text-2xl font-bold text-[#656D4A] transform md:-rotate-0 rotate-90">&rarr;</div>
                            <div class="text-center p-4 bg-white rounded-lg shadow">
                                <p class="font-bold text-lg font-heading text-[#656D4A]">ÇIKTI (Biyokütle)</p>
                                <p class="text-[#A2B29F]">Biyoyakıt & Gübre</p>
                                <p class="text-[#A2B29F]">Hayvan Yemi & Gıda</p>
                            </div>
                        </div>
                    </div>
                     <div>
                        <h3 class="text-2xl font-bold font-heading mb-6 text-center text-[#333D29]">Eğitim ve STEM Farkındalığı</h3>
                        <div id="stem-projects-container" class="space-y-4">
                            <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow">
                                <h4 class="font-bold text-[#656D4A]">Uygulamalı Öğrenme</h4>
                                <p class="text-sm text-[#A2B29F]">Öğrenciler, "Alglerden İp Yapımı" veya "Kendin Yap Güneş Fırını" gibi projelerle sürdürülebilirlik kavramlarını somut olarak deneyimler.</p>
                            </div>
                            <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow">
                                <h4 class="font-bold text-[#656D4A]">Teknoloji Entegrasyonu</h4>
                                <p class="text-sm text-[#A2B29F]">IoT sensörleri ile sistem verilerini izlemek, öğrencilere veri analizi ve mühendislik becerileri kazandırır.</p>
                            </div>
                        </div>
                        
                        <div class="mt-8 p-6 bg-white rounded-lg shadow-lg border border-gray-200">
                            <h4 class="text-xl font-bold font-heading mb-4 text-[#333D29]">Kendi Projenizi Ekleyin!</h4>
                            <div class="mb-4">
                                <label for="project-title" class="block text-sm font-medium text-[#656D4A] mb-1">Proje Başlığı:</label>
                                <input type="text" id="project-title" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#A2B29F]" placeholder="Örn: Evde Atık Su Arıtma Projesi">
                            </div>
                            <div class="mb-4">
                                <label for="project-description" class="block text-sm font-medium text-[#656D4A] mb-1">Proje Açıklaması:</label>
                                <textarea id="project-description" rows="3" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#A2B29F]" placeholder="Projenin kısa bir açıklamasını girin..."></textarea>
                            </div>
                            <button id="add-project-btn" class="active-btn px-6 py-2 rounded-md font-semibold transition-colors w-full">Proje Ekle</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="sensors" class="py-16 md:py-24">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold font-heading text-[#333D29]">Canlı Sensör Verileri: Mikroalg Sistemini İzleyin</h2>
                    <p class="mt-4 text-lg text-[#656D4A] max-w-3xl mx-auto">
                        Bu bölüm, mikroalg sisteminin canlı çevresel verilerini göstermektedir. Veriler, donanımdan gelen gerçek zamanlı akışla güncellenecektir.
                    </p>
                </div>
                <!-- Sayısal Sensör Değerleri -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="bg-white p-6 rounded-lg shadow-lg text-center border border-gray-200">
                        <h3 class="text-xl font-bold font-heading text-[#656D4A]">CO₂ Seviyesi</h3>
                        <p id="co2-value" class="text-4xl font-bold text-[#333D29] mt-2">-- ppm</p>
                    </div>
                     <div class="bg-white p-6 rounded-lg shadow-lg text-center border border-gray-200">
                        <h3 class="text-xl font-bold font-heading text-[#656D4A]">Hava Kalitesi (MQ135)</h3>
                        <p id="mq135-value" class="text-4xl font-bold text-[#333D29] mt-2">-- mV</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg text-center border border-gray-200">
                        <h3 class="text-xl font-bold font-heading text-[#656D4A]">Işık Şiddeti</h3>
                        <p id="light-value" class="text-4xl font-bold text-[#333D29] mt-2">-- lux</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg text-center border border-gray-200">
                        <h3 class="text-xl font-bold font-heading text-[#656D4A]">Sıcaklık ve Nem</h3>
                        <p id="temp-value" class="text-4xl font-bold text-[#333D29] mt-2">-- °C</p>
                        <p id="humidity-value" class="text-4xl font-bold text-[#333D29] mt-2">-- %</p>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200 text-center mb-8">
                    <h3 class="text-xl font-bold font-heading text-[#333D29] mb-4">Sistem Durumu Mesajı</h3>
                    <p id="status-message" class="text-lg text-[#656D4A]">Sensör verileri yükleniyor...</p>
                </div>

                <!-- Grafiksel Sensör Verileri -->
                <div class="text-center mb-8">
                    <h3 class="text-2xl font-bold font-heading text-[#333D29] mb-4">Veri Grafikleri (Son 30 Okuma)</h3>
                    <button id="download-csv-btn" class="active-btn px-6 py-2 rounded-md font-semibold transition-colors">Verileri CSV Olarak İndir</button>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200">
                        <h4 class="text-lg font-bold font-heading text-[#656D4A] mb-4 text-center">CO₂ Seviyesi Trendi</h4>
                        <div class="chart-container">
                            <canvas id="co2ChartCanvas"></canvas>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200">
                        <h4 class="text-lg font-bold font-heading text-[#656D4A] mb-4 text-center">Hava Kalitesi (MQ135) Trendi</h4>
                        <div class="chart-container">
                            <canvas id="mq135ChartCanvas"></canvas>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200">
                        <h4 class="text-lg font-bold font-heading text-[#656D4A] mb-4 text-center">Işık Şiddeti Trendi</h4>
                        <div class="chart-container">
                            <canvas id="lightChartCanvas"></canvas>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200">
                        <h4 class="text-lg font-bold font-heading text-[#656D4A] mb-4 text-center">Sıcaklık ve Nem Trendi</h4>
                        <div class="chart-container">
                            <canvas id="tempHumidityChartCanvas"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="future" class="py-16 md:py-24">
             <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold font-heading text-[#333D29]">Gelecek Vizyonu ve Öneriler</h2>
                     <p class="mt-4 text-lg text-[#656D4A] max-w-3xl mx-auto">
                        Bu teknolojinin potansiyelini tam olarak hayata geçirmek için stratejik adımlar atılmalıdır.
                    </p>
                </div>
                <div class="grid md:grid-cols-3 gap-8 text-center">
                    <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200">
                        <div class="text-4xl mb-4 text-[#B6AD90]">⚙️</div>
                        <h3 class="text-xl font-bold font-heading mb-2">Teknoloji Geliştirme</h3>
                        <p class="text-[#656D4A]">Daha dayanıklı alg türleri araştırmak, FBR tasarımlarını optimize etmek ve maliyetleri düşürmek.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200">
                        <div class="text-4xl mb-4 text-[#B6AD90]">🌍</div>
                        <h3 class="text-xl font-bold font-heading mb-2">Saha Uygulamaları</h3>
                        <p class="text-[#656D4A]">Mobil ünitelerin afet senaryolarında test edilmesi ve mevcut altyapılarla entegrasyonu.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200">
                        <div class="text-4xl mb-4 text-[#B6AD90]">🤝</div>
                        <h3 class="text-xl font-bold font-heading mb-2">Ekonomik Sürdürülebilirlik</h3>
                        <p class="text-[#656D4A]">Biyokütle yan ürünlerinin pazarını geliştirmek ve yatırım için yeni finansman modelleri oluşturmak.</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="bg-[#333D29] text-[#F8F7F4] py-8">
        <div class="container mx-auto px-6 text-center">
            <p>&copy; 2025 İnteraktif Rapor. Literatür Taraması Verilerinden Oluşturulmuştur.</p>
            <p class="text-sm text-[#A2B29F] mt-2">Bu uygulama, BIQ-Alg 0CO2 projesinin literatür taraması raporundan esinlenmiştir.</p>
        </div>
    </footer>

    <div id="message-box" class="message-box">
        <p id="message-text"></p>
    </div>

    <script type="module">
        // Firebase SDK'larını içe aktarın
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        document.addEventListener('DOMContentLoaded', function () {
            
            // Mevcut pbrData ve pbrInfo tanımlamaları... (Bu kısım değişmedi)
            const pbrData = {
                labels: ['CO₂ Fiksasyon Verimliliği (%)'],
                datasets: [
                    { label: 'Açık Havuzlar', data: [90], backgroundColor: '#A2B29F' },
                    { label: 'Tübüler FBR', data: [76], backgroundColor: '#656D4A', hidden: true },
                    { label: 'Düz Panel FBR', data: [85], backgroundColor: '#B6AD90', hidden: true },
                    { label: 'Kabarcık Kolon FBR', data: [90], backgroundColor: '#333D29', hidden: true }
                ]
            };
            
            const pbrInfo = {
                'btn-pbr-1': { title: 'Açık Havuzlar', description: '<p class="mb-2"><strong class="text-[#656D4A]">Avantajları:</strong> Düşük kurulum maliyeti, büyük ölçekli endüstriyel büyüme için uygun.</p><p><strong class="text-[#656D4A]">Dezavantajları:</strong> Geniş alan gereksinimi, dengesiz kültür koşulları, kirlilik riski.</p>' },
                'btn-pbr-2': { title: 'Tübüler FBR', description: '<p class="mb-2"><strong class="text-[#656D4A]">Avantajları:</strong> Aseptik çalışma, stabil koşullar, su buharlaşmasını önler, mimari entegrasyon potansiyeli.</p><p><strong class="text-[#656D4A]">Dezavantajları:</strong> Yüksek inşaat ve işletme maliyetleri.</p>' },
                'btn-pbr-3': { title: 'Düz Panel FBR', description: '<p class="mb-2"><strong class="text-[#656D4A]">Avantajları:</strong> Olağanüstü CO₂ emilimi, optimize edilmiş mikroalg büyümesi, yüksek karbon tutulumu.</p><p><strong class="text-[#656D4A]">Dezavantajları:</strong> Yüksek teknoloji gereksinimi.</p>' },
                'btn-pbr-4': { title: 'Kabarcık Kolon FBR', description: '<p class="mb-2"><strong class="text-[#656D4A]">Avantajları:</strong> Sıcaklık kontrolü, düşük basınç düşüşü, yüksek arayüzey alanı.</p><p><strong class="text-[#656D4A]">Dezavantajları:</strong> Yüksek konsantrasyonlarda etkilidir, daha karmaşık yapı.</p>' }
            };

            const pbrCtx = document.getElementById('pbrChart').getContext('2d');
            const pbrChart = new Chart(pbrCtx, {
                type: 'bar',
                data: pbrData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            title: { display: true, text: 'Verimlilik (%)' }
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: ${context.raw}%`;
                                }
                            }
                        }
                    }
                }
            });

            const pbrButtons = document.querySelectorAll('.pbr-btn');
            pbrButtons.forEach((button, index) => {
                button.addEventListener('click', () => {
                    pbrButtons.forEach(btn => {
                        btn.classList.remove('active-btn');
                        btn.classList.add('inactive-btn');
                    });
                    button.classList.add('active-btn');
                    button.classList.remove('inactive-btn');

                    pbrChart.data.datasets.forEach((dataset, i) => {
                        dataset.hidden = (i !== index);
                    });
                    pbrChart.update();
                    
                    const info = pbrInfo[button.id];
                    document.getElementById('pbr-title').innerText = info.title;
                    document.getElementById('pbr-description').innerHTML = info.description;
                });
            });

            const mobileSystemsData = {
                labels: ['aerium', 'Vayu', 'Liquid 3'],
                datasets: [{
                    label: 'Eşdeğer Ev Bitkisi/Ağaç Sayısı',
                    data: [25, 40, 200], 
                    backgroundColor: ['#A2B29F', '#656D4A', '#B6AD90'],
                    borderColor: '#F8F7F4',
                    borderWidth: 2
                }]
            };

            const mobileSystemsCtx = document.getElementById('mobileSystemsChart').getContext('2d');
            new Chart(mobileSystemsCtx, {
                type: 'doughnut',
                data: mobileSystemsData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        tooltip: {
                             callbacks: {
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed !== null) {
                                        let value = context.parsed;
                                        if (context.label === 'Liquid 3') {
                                           label += `${value / 100} ağaca eşdeğer`;
                                        } else {
                                           label += `${value} ev bitkisine eşdeğer`;
                                        }
                                    }
                                    return label;
                                }
                            }
                        },
                        title: {
                            display: true,
                            text: 'Performans (Eşdeğer Bitki/Ağaç Sayısı)',
                            padding: { top: 10, bottom: 10 }
                        }
                    }
                }
            });
            
            const navLinks = document.querySelectorAll('header nav a');
            const sections = document.querySelectorAll('main section');
            
            window.addEventListener('scroll', () => {
                let current = '';
                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    if (pageYOffset >= sectionTop - 60) {
                        current = section.getAttribute('id');
                    }
                });

                navLinks.forEach(link => {
                    link.classList.remove('active-nav');
                    link.classList.add('inactive-nav');
                    if (link.href.includes(current)) {
                        link.classList.add('active-nav');
                        link.classList.remove('inactive-nav');
                    }
                });
            });

            // STEM Proje Ekleme Mantığı (Değişmedi)
            const addProjectBtn = document.getElementById('add-project-btn');
            const projectTitleInput = document.getElementById('project-title');
            const projectDescriptionInput = document.getElementById('project-description');
            const stemProjectsContainer = document.getElementById('stem-projects-container');
            const messageBox = document.getElementById('message-box');
            const messageText = document.getElementById('message-text');

            function showMessage(message, duration = 3000) {
                messageText.innerText = message;
                messageBox.classList.add('show');
                setTimeout(() => {
                    messageBox.classList.remove('show');
                }, duration);
            }

            addProjectBtn.addEventListener('click', () => {
                const title = projectTitleInput.value.trim();
                const description = projectDescriptionInput.value.trim();

                if (title === '' || description === '') {
                    showMessage('Lütfen proje başlığı ve açıklamasını girin.');
                    return;
                }

                const newProjectDiv = document.createElement('div');
                newProjectDiv.className = 'bg-white p-4 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow';
                newProjectDiv.innerHTML = `
                    <h4 class="font-bold text-[#656D4A]">${title}</h4>
                    <p class="text-sm text-[#A2B29F]">${description}</p>
                `;
                stemProjectsContainer.appendChild(newProjectDiv);

                projectTitleInput.value = '';
                projectDescriptionInput.value = '';
                showMessage('Proje başarıyla eklendi!');
            });

            // Sensör Veri Görüntüleme Elemanları
            const co2ValueSpan = document.getElementById('co2-value');
            const mq135ValueSpan = document.getElementById('mq135-value');
            const lightValueSpan = document.getElementById('light-value');
            const tempValueSpan = document.getElementById('temp-value');
            const humidityValueSpan = document.getElementById('humidity-value');
            const statusMessageP = document.getElementById('status-message');

            function updateStatusMessage(co2, mq135, light, temperature, humidity) {
                let message = 'Sistem durumu iyi. Mikroalgler aktif olarak çalışıyor.';

                if (co2 === '--' || mq135 === '--' || light === '--' || temperature === '--' || humidity === '--') {
                    message = "Sensör verileri yükleniyor veya eksik...";
                } else {
                    if (co2 > 800) {
                        message = 'Yüksek CO₂ seviyesi tespit edildi! Mikroalglerin fotosentezi hızlanabilir.';
                    } else if (co2 < 400) {
                        message = 'CO₂ seviyesi düşük, fotosentez yavaşlayabilir. CO₂ takviyesi düşünülebilir.';
                    }

                    if (mq135 > 200) { // MQ135 için örnek eşik (mV veya ADC değeri)
                        if (message === 'Sistem durumu iyi. Mikroalgler aktif olarak çalışıyor.') { // Mesajı tekrar etmemek için kontrol
                            message = '';
                        }
                        message += ' Hava kalitesi düşük algılandı, havalandırma kontrol edilmeli.';
                    }

                    if (light < 100) { // Lux cinsinden örnek eşik
                         if (message === 'Sistem durumu iyi. Mikroalgler aktif olarak çalışıyor.') {
                            message = '';
                        }
                        message += ' Işık seviyesi düşük, fotosentez için ışık takviyesi düşünülebilir.';
                    } else if (light > 1000) { // Lux cinsinden örnek eşik
                         if (message === 'Sistem durumu iyi. Mikroalgler aktif olarak çalışıyor.') {
                            message = '';
                        }
                        message += ' Işık seviyesi yüksek, aşırı ışık stresi olabilir.';
                    }

                    if (temperature > 28) {
                        if (message === 'Sistem durumu iyi. Mikroalgler aktif olarak çalışıyor.') {
                            message = '';
                        }
                        message += ' Su sıcaklığı yüksek, soğutma gerekli olabilir.';
                    } else if (temperature < 22) {
                        if (message === 'Sistem durumu iyi. Mikroalgler aktif olarak çalışıyor.') {
                            message = '';
                        }
                        message += ' Su sıcaklığı düşük, ısıtma gerekli olabilir.';
                    }

                    if (humidity < 40) {
                        if (message === 'Sistem durumu iyi. Mikroalgler aktif olarak çalışıyor.') {
                            message = '';
                        }
                        message += ' Nem seviyesi düşük, buharlaşma artabilir.';
                    } else if (humidity > 70) {
                        if (message === 'Sistem durumu iyi. Mikroalgler aktif olarak çalışıyor.') {
                            message = '';
                        }
                        message += ' Nem seviyesi yüksek, yoğuşma ve mantar riski olabilir.';
                    }

                    if (message === '') { // Eğer özel bir sorun yoksa, varsayılan iyi mesaja geri dön
                        message = 'Sistem durumu iyi. Mikroalgler aktif olarak çalışıyor.';
                    }
                }
                statusMessageP.innerText = message;
            }

            // Firebase Entegrasyonu Başlangıcı
            let db; // Firestore veritabanı örneği
            let auth; // Firebase kimlik doğrulama örneği
            let userId; // Kullanıcı kimliği
            
            // Canvas tarafından sağlanan global değişkenleri kullanın
            const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
            const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

            // Firebase'i başlat
            try {
                const app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                auth = getAuth(app);

                // Kimlik doğrulama durumu değiştiğinde dinleyici
                onAuthStateChanged(auth, async (user) => {
                    if (!user) {
                        // Kullanıcı oturum açmadıysa anonim olarak oturum açmayı dene
                        try {
                            if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                                await signInWithCustomToken(auth, __initial_auth_token);
                                console.log("Özel token ile oturum açıldı.");
                            } else {
                                await signInAnonymously(auth);
                                console.log("Anonim olarak oturum açıldı.");
                            }
                            userId = auth.currentUser.uid; // Oturum açtıktan sonra userId'yi al
                            console.log("Firestore userId:", userId);
                            listenForSensorData(); // Kimlik doğrulama sonrası sensör verilerini dinlemeye başla
                        } catch (error) {
                            console.error("Firebase Kimlik Doğrulama Hatası:", error);
                            statusMessageP.innerText = "Hata: Kimlik doğrulama başarısız oldu. Sensör verileri yüklenemiyor.";
                        }
                    } else {
                        // Zaten oturum açmışsa
                        userId = user.uid;
                        console.log("Kullanıcı zaten oturum açık:", userId);
                        listenForSensorData(); // Kimlik doğrulama sonrası sensör verilerini dinlemeye başla
                    }
                });

            } catch (error) {
                console.error("Firebase Başlatma Hatası:", error);
                statusMessageP.innerText = "Hata: Firebase başlatılamadı. Sensör verileri yüklenemiyor.";
            }

            // Sensör Verisi Geçmişini Depolama ve Grafik Ayarları
            let sensorDataHistory = [];
            const MAX_DATA_POINTS = 30; // Grafikte gösterilecek maksimum veri noktası sayısı

            // Grafik Nesneleri
            let co2Chart, mq135Chart, lightChart, tempHumidityChart;

            // Grafiklerin Başlatılması
            function initializeCharts() {
                const defaultChartOptions = {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            type: 'category', // Zaman tabanlı etiketler için uygun
                            title: {
                                display: true,
                                text: 'Zaman'
                            }
                        },
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Değer'
                            }
                        }
                    },
                    plugins: {
                        legend: { display: true },
                        tooltip: { mode: 'index', intersect: false }
                    }
                };

                // CO2 Grafiği
                const co2Ctx = document.getElementById('co2ChartCanvas').getContext('2d');
                co2Chart = new Chart(co2Ctx, {
                    type: 'line',
                    data: { labels: [], datasets: [{ label: 'CO₂ (ppm)', data: [], borderColor: '#656D4A', tension: 0.1, fill: false }] },
                    options: {
                        ...defaultChartOptions,
                        scales: { ...defaultChartOptions.scales, y: { ...defaultChartOptions.scales.y, title: { display: true, text: 'CO₂ (ppm)' } } }
                    }
                });

                // MQ135 Hava Kalitesi Grafiği
                const mq135Ctx = document.getElementById('mq135ChartCanvas').getContext('2d');
                mq135Chart = new Chart(mq135Ctx, {
                    type: 'line',
                    data: { labels: [], datasets: [{ label: 'Hava Kalitesi (mV)', data: [], borderColor: '#B6AD90', tension: 0.1, fill: false }] },
                    options: {
                        ...defaultChartOptions,
                        scales: { ...defaultChartOptions.scales, y: { ...defaultChartOptions.scales.y, title: { display: true, text: 'MQ135 (mV)' } } }
                    }
                });

                // Işık Şiddeti Grafiği
                const lightCtx = document.getElementById('lightChartCanvas').getContext('2d');
                lightChart = new Chart(lightCtx, {
                    type: 'line',
                    data: { labels: [], datasets: [{ label: 'Işık Şiddeti (lux)', data: [], borderColor: '#A2B29F', tension: 0.1, fill: false }] },
                    options: {
                        ...defaultChartOptions,
                        scales: { ...defaultChartOptions.scales, y: { ...defaultChartOptions.scales.y, title: { display: true, text: 'Işık (lux)' } } }
                    }
                });

                // Sıcaklık ve Nem Grafiği
                const tempHumidityCtx = document.getElementById('tempHumidityChartCanvas').getContext('2d');
                tempHumidityChart = new Chart(tempHumidityCtx, {
                    type: 'line',
                    data: {
                        labels: [],
                        datasets: [
                            { label: 'Sıcaklık (°C)', data: [], borderColor: '#333D29', tension: 0.1, fill: false },
                            { label: 'Nem (%)', data: [], borderColor: '#8E9B8D', tension: 0.1, fill: false }
                        ]
                    },
                    options: {
                        ...defaultChartOptions,
                        scales: { ...defaultChartOptions.scales, y: { ...defaultChartOptions.scales.y, title: { display: true, text: 'Değer' } } }
                    }
                });
            }

            // Firebase'den gerçek zamanlı sensör verilerini dinleme
            function listenForSensorData() {
                const sensorDocRef = doc(db, `artifacts/${appId}/public/data/sensors/current_data`);

                onSnapshot(sensorDocRef, (docSnap) => {
                    if (docSnap.exists()) {
                        const data = docSnap.data();
                        const timestamp = data.timestamp && data.timestamp.toDate ? data.timestamp.toDate() : new Date(); // Firestore Timestamp'ı JS Date'e dönüştür

                        // Geçmişe yeni veri noktası ekle
                        const newDataPoint = {
                            timestamp: timestamp,
                            co2: data.co2,
                            mq135_value: data.mq135_value,
                            light_value: data.light_value,
                            temperature: data.temperature,
                            humidity: data.humidity
                        };
                        sensorDataHistory.push(newDataPoint);

                        // Performans için geçmiş boyutunu sınırla
                        if (sensorDataHistory.length > MAX_DATA_POINTS) {
                            sensorDataHistory.shift(); // En eski noktayı kaldır
                        }

                        // Sayısal ekranları güncelle
                        co2ValueSpan.innerText = `${data.co2 || '--'} ppm`;
                        mq135ValueSpan.innerText = `${data.mq135_value || '--'} mV`;
                        lightValueSpan.innerText = `${data.light_value || '--'} lux`;
                        tempValueSpan.innerText = `${data.temperature || '--'} °C`;
                        humidityValueSpan.innerText = `${data.humidity || '--'} %`;
                        updateStatusMessage(data.co2, data.mq135_value, data.light_value, data.temperature, data.humidity);

                        // Grafikleri güncelle
                        updateCharts();
                    } else {
                        console.log("Sensör verisi bulunamadı veya henüz veri gönderilmedi!");
                        statusMessageP.innerText = "Sensör verisi bekleniyor... Lütfen Arduino'nuzdan veri göndermeyi başlatın.";
                        co2ValueSpan.innerText = "-- ppm";
                        mq135ValueSpan.innerText = "-- mV";
                        lightValueSpan.innerText = "-- lux";
                        tempValueSpan.innerText = "-- °C";
                        humidityValueSpan.innerText = "-- %";
                    }
                }, (error) => {
                    console.error("Firestore'dan veri çekerken hata oluştu:", error);
                    statusMessageP.innerText = "Hata: Sensör verileri yüklenemiyor. Konsolu kontrol edin.";
                });
            }

            // Tüm grafikleri güncelleme fonksiyonu
            function updateCharts() {
                const labels = sensorDataHistory.map(point => new Date(point.timestamp).toLocaleTimeString('tr-TR'));

                // CO2 Grafiği güncelle
                co2Chart.data.labels = labels;
                co2Chart.data.datasets[0].data = sensorDataHistory.map(point => point.co2);
                co2Chart.update();

                // MQ135 Grafiği güncelle
                mq135Chart.data.labels = labels;
                mq135Chart.data.datasets[0].data = sensorDataHistory.map(point => point.mq135_value);
                mq135Chart.update();

                // Işık Grafiği güncelle
                lightChart.data.labels = labels;
                lightChart.data.datasets[0].data = sensorDataHistory.map(point => point.light_value);
                lightChart.update();

                // Sıcaklık ve Nem Grafiği güncelle
                tempHumidityChart.data.labels = labels;
                tempHumidityChart.data.datasets[0].data = sensorDataHistory.map(point => point.temperature);
                tempHumidityChart.data.datasets[1].data = sensorDataHistory.map(point => point.humidity);
                tempHumidityChart.update();
            }

            // CSV İndirme İşlevi
            const downloadCsvBtn = document.getElementById('download-csv-btn');
            if (downloadCsvBtn) {
                downloadCsvBtn.addEventListener('click', exportToCsv);
            }

            function exportToCsv() {
                if (sensorDataHistory.length === 0) {
                    showMessage("Dışa aktarılacak veri bulunamadı.");
                    return;
                }

                const headers = ["Timestamp", "CO2 (ppm)", "Hava Kalitesi (MQ135 mV)", "Işık (lux)", "Sıcaklık (°C)", "Nem (%)"];
                let csvContent = headers.join(",") + "\n";

                sensorDataHistory.forEach(row => {
                    const timestamp = row.timestamp ? new Date(row.timestamp).toLocaleString('tr-TR') : '';
                    const values = [
                        row.co2,
                        row.mq135_value,
                        row.light_value,
                        row.temperature,
                        row.humidity
                    ];
                    csvContent += [timestamp, ...values].join(",") + "\n"; // Timestamp'ı da ekleyin
                });

                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                if (link.download !== undefined) { // Tarayıcı desteğini kontrol et
                    const url = URL.createObjectURL(blob);
                    link.setAttribute('href', url);
                    link.setAttribute('download', 'mikroalg_sensor_verileri.csv');
                    link.style.visibility = 'hidden';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    URL.revokeObjectURL(url);
                    showMessage("Veriler CSV olarak dışa aktarıldı!");
                } else {
                    showMessage("Tarayıcınız CSV dışa aktarımı desteklemiyor.");
                }
            }

            // Sayfa yüklendiğinde grafikleri başlat
            initializeCharts();
        });
    </script>
</body>
</html>



