<!DOCTYPE html>
<html lang="tr" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BIQ-Alg 0CO2: Afet Bölgesi İçin İnovatif Hava Çözümü</title>
    
    <!-- Seçilen Palet: Energetic & Playful (#FF6B6B, #FFD166, #06D6A0, #118AB2, #073B4C) -->
    <!-- ONAYLAMA: SVG grafikleri kullanılmamıştır. NO Mermaid JS used. -->

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700;900&family=Montserrat:wght@700;800&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f8f9fa;
            color: #073B4C; 
        }
        .font-heading {
            font-family: 'Montserrat', sans-serif;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 550px;
            margin-left: auto;
            margin-right: auto;
            height: 320px;
            max-height: 450px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
        .kpi-card {
            background: #ffffff;
            border-radius: 0.75rem;
            padding: 1rem;
            text-align: center;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        .flow-arrow {
            color: #118AB2;
            font-size: 2.5rem;
            line-height: 1;
        }
        .flow-box {
            border: 2px solid #06D6A0;
        }
        .summary-table th {
            background-color: #118AB2;
            color: white;
            padding: 1rem;
            text-align: left;
        }
        .summary-table td {
            background-color: #ffffff;
            padding: 1rem;
            border-bottom: 1px solid #e9ecef;
        }
        .summary-table tr:last-child td {
            border-bottom: none;
        }
        .summary-table td:first-child {
            font-weight: bold;
            color: #073B4C;
        }
        .nav-link.active {
            color: #118AB2;
            font-weight: 700;
        }
        .message-box {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #073B4C;
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
            transform: translate(-50%, 20px);
        }
        .message-box.show {
            opacity: 1;
            transform: translate(-50%, 0);
        }
    </style>
</head>

<body class="antialiased">

    <header class="bg-white/95 backdrop-blur-sm sticky top-0 z-50 shadow-md">
        <nav class="container mx-auto px-6 py-3 flex justify-between items-center">
            <a href="#hero" class="flex items-center">
                <img src="logo111.png" alt="BIQ-Alg 0CO2 Proje Logosu" class="h-12 w-auto" onerror="this.onerror=null; this.src='https://placehold.co/150x50/FFFFFF/073B4C?text=BiQ-Alg+0CO2';">
            </a>
            <div class="hidden md:flex items-center space-x-8">
                <a href="#problem-solution" class="nav-link text-gray-600 hover:text-[#118AB2] font-semibold transition-colors">Çözüm</a>
                <a href="#technology" class="nav-link text-gray-600 hover:text-[#118AB2] font-semibold transition-colors">Teknoloji</a>
                <a href="#live-data" class="nav-link text-gray-600 hover:text-[#118AB2] font-semibold transition-colors">Canlı Veri</a>
                <a href="#summary-table-section" class="nav-link text-gray-600 hover:text-[#118AB2] font-semibold transition-colors">Özet</a>
                <a href="#future" class="nav-link text-gray-600 hover:text-[#118AB2] font-semibold transition-colors">Gelecek</a>
            </div>
        </nav>
    </header>

    <main>
        <section id="hero" class="py-20 md:py-32" style="background: linear-gradient(135deg, #118AB2 0%, #06D6A0 100%);">
            <div class="container mx-auto px-6 text-center text-white">
                <h1 class="text-4xl md:text-6xl font-bold font-heading mb-4 tracking-tight">Afet Sonrası Temiz Nefes: <br> BIQ-Alg 0CO2</h1>
                <p class="text-lg md:text-xl max-w-3xl mx-auto opacity-90">
                    Doğanın en güçlü savaşçıları olan mikroalgler ile afet bölgelerine anında hava kalitesi, sürdürülebilir enerji ve umut taşıyan mobil eğitim istasyonunu keşfedin.
                </p>
            </div>
        </section>

        <section id="problem-solution" class="py-16 md:py-24">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12 md:mb-16">
                    <h2 class="text-3xl md:text-4xl font-bold font-heading text-[#073B4C]">Görünmez Tehlikeye Karşı Biyolojik Kalkan</h2>
                    <p class="mt-4 text-lg text-[#073B4C] max-w-3xl mx-auto">
                        Afetler, ardında sadece enkaz bırakmaz; aynı zamanda havayı kirleten tehlikeli partiküllerle doldurur. Geleneksel çözümler yetersiz kalırken, doğa bize çok daha güçlü bir alternatif sunuyor.
                    </p>
                </div>
                <div class="grid md:grid-cols-3 gap-8 items-center text-center">
                    <div class="bg-white p-8 rounded-xl shadow-lg">
                        <h3 class="font-heading text-2xl font-bold text-[#FF6B6B] mb-3">GELENEKSEL YÖNTEMLER</h3>
                        <p class="text-gray-600">Enerji yoğun, maliyetli ve sadece partikül filtreler. CO₂ yakalama veya O₂ üretme yetenekleri yoktur.</p>
                    </div>
                    <div class="p-8">
                         <div class="text-6xl md:text-8xl font-black text-[#118AB2] font-heading">50x</div>
                         <p class="font-bold text-xl mt-2 text-[#073B4C]">DAHA VERİMLİ</p>
                         <p class="text-gray-600 mt-1">Mikroalgler, karasal bitkilere göre 10 ila 50 kat daha verimli CO₂ yakalar.</p>
                    </div>
                    <div class="bg-white p-8 rounded-xl shadow-lg">
                        <h3 class="font-heading text-2xl font-bold text-[#06D6A0] mb-3">MİKROALG ÇÖZÜMÜ</h3>
                        <p class="text-gray-600">Havayı temizler, oksijen üretir ve döngüsel ekonomi için değerli biyokütle oluşturur.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="technology" class="py-16 md:py-24 bg-gray-100">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12 md:mb-16">
                    <h2 class="text-3xl md:text-4xl font-bold font-heading text-[#073B4C]">Hava Arıtmanın Kalbi: Fotobiyoreaktör (FBR) Teknolojileri</h2>
                    <p class="mt-4 text-lg text-[#073B4C] max-w-3xl mx-auto">
                        Mikroalglerin gücünü en verimli şekilde kullanmak için farklı reaktör tasarımları mevcuttur. Her birinin kendine özgü avantajları ve performans metrikleri bulunur. Projemiz, mobilite ve verimliliği birleştiren Dikey Tübüler FBR tasarımını temel alır.
                    </p>
                </div>
                <div class="grid md:grid-cols-2 gap-8 items-center">
                    <div class="chart-container">
                        <canvas id="pbrPerformanceChart"></canvas>
                    </div>
                    <div id="pbr-info" class="space-y-4">
                        <div class="bg-white p-6 rounded-lg shadow-md transition-all duration-300">
                             <h3 class="text-xl font-bold font-heading mb-2 text-[#118AB2]">Dikey Tübüler FBR (Projemizin Seçimi)</h3>
                            <p class="text-gray-600">Kompakt yapısıyla mobil uygulamalar için idealdir. Kontrollü ortamı sayesinde yüksek verimlilik ve stabilite sunar. Az yer kaplar ve afet bölgelerinde hızla kurulabilir.</p>
                        </div>
                         <div class="bg-white p-6 rounded-lg shadow-md transition-all duration-300 opacity-70">
                             <h3 class="text-xl font-bold font-heading mb-2 text-[#073B4C]">Düz Panel FBR</h3>
                            <p class="text-gray-600">Yüksek ışık verimliliği sağlar ancak genellikle daha büyük ve sabit kurulumlar için uygundur.</p>
                        </div>
                         <div class="bg-white p-6 rounded-lg shadow-md transition-all duration-300 opacity-70">
                             <h3 class="text-xl font-bold font-heading mb-2 text-[#073B4C]">Açık Havuz Sistemleri</h3>
                            <p class="text-gray-600">Düşük maliyetlidir ancak kirlenme riski yüksek ve verimliliği düşüktür.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="station-design" class="py-16 md:py-24">
            <div class="container mx-auto px-6">
                 <div class="text-center mb-12 md:mb-16">
                    <h2 class="text-3xl md:text-4xl font-bold font-heading text-[#073B4C]">Mobil Hava Kalitesi İstasyonu</h2>
                    <p class="mt-4 text-lg text-[#073B4C] max-w-3xl mx-auto">
                        İşte afet bölgelerinde hızlıca kurulmak üzere tasarlanan BIQ-Alg 0CO2 istasyonunun konsept tasarımı.
                    </p>
                </div>
                <div class="grid lg:grid-cols-2 gap-8 items-center">
                    <div class="bg-white p-8 rounded-xl shadow-lg border-t-8 border-[#06D6A0]">
                        <h3 class="text-2xl font-bold font-heading mb-4 text-[#073B4C]">Tasarım Felsefesi</h3>
                        <p class="text-gray-600 mb-4">
                            İstasyon, **modüler, taşınabilir ve kendi kendine yeten** bir yapıdadır. Şeffaf tübüler reaktör, maksimum ışık alımını sağlarken, entegre IoT sensörleri ve otomasyon sistemleri minimum bakım gerektirir.
                        </p>
                        <ul class="space-y-2 text-gray-700">
                            <li class="flex items-center"><span class="text-green-500 mr-2">✔</span> Otomatik su ve besin yönetimi</li>
                            <li class="flex items-center"><span class="text-green-500 mr-2">✔</span> Enerji verimli hava kabarcıklandırma sistemi</li>
                            <li class="flex items-center"><span class="text-green-500 mr-2">✔</span> Canlı veri takibi için entegre monitör</li>
                            <li class="flex items-center"><span class="text-green-500 mr-2">✔</span> Döngüsel ekonomi için biyokütle toplama haznesi</li>
                        </ul>
                    </div>
                    <div>
                        <img src="https://i.imgur.com/kK5GgQW.png" alt="BIQ-Alg 0CO2 Hava İstasyonu Tasarımı" class="rounded-xl shadow-2xl w-full h-auto">
                    </div>
                </div>
            </div>
        </section>
        
        <section id="live-data" class="py-16 md:py-24 bg-gray-100">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12 md:mb-16">
                    <h2 class="text-3xl md:text-4xl font-bold font-heading text-[#073B4C]">Canlı Veri İzleme Paneli</h2>
                    <p class="mt-4 text-lg text-[#073B4C] max-w-3xl mx-auto">
                        BIQ-Alg 0CO2 istasyonundan gelen gerçek zamanlı sensör verilerini buradan takip edin. Bu panel, sistemin anlık performansını ve çevre koşullarını gösterir.
                    </p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-8 text-center">
                    <div class="kpi-card p-4 rounded-lg shadow-md">
                        <h4 class="font-bold text-gray-500 text-sm">CO₂ SEVİYESİ</h4>
                        <p id="kpi-co2" class="text-3xl font-black text-[#118AB2] mt-1">--- <span class="text-lg">ppm</span></p>
                    </div>
                    <div class="kpi-card p-4 rounded-lg shadow-md">
                        <h4 class="font-bold text-gray-500 text-sm">HAVA KALİTESİ</h4>
                        <p id="kpi-mq135" class="text-3xl font-black text-[#06D6A0] mt-1">---</p>
                    </div>
                    <div class="kpi-card p-4 rounded-lg shadow-md">
                        <h4 class="font-bold text-gray-500 text-sm">IŞIK ŞİDDETİ</h4>
                        <p id="kpi-light" class="text-3xl font-black text-[#FFD166] mt-1">--- <span class="text-lg">lux</span></p>
                    </div>
                    <div class="kpi-card p-4 rounded-lg shadow-md">
                        <h4 class="font-bold text-gray-500 text-sm">SICAKLIK</h4>
                        <p id="kpi-temp" class="text-3xl font-black text-[#FF6B6B] mt-1">-- <span class="text-lg">°C</span></p>
                    </div>
                    <div class="kpi-card p-4 rounded-lg shadow-md">
                        <h4 class="font-bold text-gray-500 text-sm">NEM</h4>
                        <p id="kpi-humidity" class="text-3xl font-black text-[#118AB2] mt-1">-- <span class="text-lg">%</span></p>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="bg-white p-6 rounded-xl shadow-lg">
                        <h3 class="text-xl font-bold font-heading text-center mb-4 text-[#073B4C]">Sıcaklık ve Nem Trendi (Son 30 Okuma)</h3>
                        <div class="chart-container" style="height: 300px; max-height: 300px;">
                            <canvas id="tempHumidityChart"></canvas>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-lg">
                        <h3 class="text-xl font-bold font-heading text-center mb-4 text-[#073B4C]">CO₂ Seviyesi Trendi (Son 30 Okuma)</h3>
                        <div class="chart-container" style="height: 300px; max-height: 300px;">
                            <canvas id="co2Chart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="summary-table-section" class="py-16 md:py-24">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12 md:mb-16">
                    <h2 class="text-3xl md:text-4xl font-bold font-heading text-[#073B4C]">Projenin Öne Çıkan Yönleri</h2>
                    <p class="mt-4 text-lg text-[#073B4C] max-w-3xl mx-auto">
                        Aşağıdaki tablo, projemizin temel yeteneklerini ve topluma sağladığı çok yönlü faydaları özetlemektedir.
                    </p>
                </div>
                <div class="overflow-x-auto">
                    <table class="summary-table w-full min-w-full rounded-lg shadow-lg overflow-hidden">
                        <thead>
                            <tr>
                                <th class="w-1/3">Özellik / Alan</th>
                                <th>Açıklama</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Problem Odaklı Geliştirme</td>
                                <td>Türkiye'de yaşanılan 6 Şubat deprem felaketindeki atmosfer verileri toplanmış ve sistemin geliştirilmesinde bu verilerden yararlanılmıştır.</td>
                            </tr>
                            <tr>
                                <td>Mobilite ve Anlık Analiz</td>
                                <td>İstasyon mobil bir yapıdadır. Geliştirilen sistem, afet bölgesindeki atmosfer verilerini (CO₂, PM2.5 vb.) anlık olarak analiz eder, bölgedeki hava kalitesi hakkında bilgi verir ve bu verileri kayıt altına alır.</td>
                            </tr>
                            <tr>
                                <td>Çok Yönlü Fayda</td>
                                <td>Sistem; afetzedeler için deneyimsel öğrenme ortamı oluşturur, hava kalitesini iyileştirir, ürettiği biyokütle ile döngüsel ekonomiye katkıda bulunur ve ürettiği oksijen ile daha sağlıklı bir yaşam ortamı sağlar.</td>
                            </tr>
                            <tr>
                                <td>Çift Amaçlı Yapı</td>
                                <td>Projemiz, hem afet bölgesindeki hava kalitesini etkili bir şekilde iyileştirmekte hem de interaktif bir STEM eğitim istasyonu olarak görev görmektedir.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>
        <section id="future" class="py-16 md:py-24 bg-gray-100">
             <div class="container mx-auto px-6">
                <div class="text-center mb-12 md:mb-16">
                    <h2 class="text-3xl md:text-4xl font-bold font-heading text-[#073B4C]">Gelecek Vizyonumuz</h2>
                     <p class="mt-4 text-lg text-[#073B4C] max-w-3xl mx-auto">
                        Bu proje, daha yeşil ve sağlıklı bir gelecek için sadece bir başlangıç.
                    </p>
                </div>
                <div class="grid md:grid-cols-3 gap-8 text-center">
                    <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-xl transition-shadow">
                        <div class="text-5xl mb-4">⚙️</div>
                        <h3 class="text-xl font-bold font-heading mb-2 text-[#118AB2]">Teknoloji Geliştirme</h3>
                        <p class="text-gray-600">Daha verimli ve dayanıklı alg türleri araştırmak, FBR tasarımlarını optimize etmek ve maliyetleri düşürmek.</p>
                    </div>
                    <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-xl transition-shadow">
                        <div class="text-5xl mb-4">🌍</div>
                        <h3 class="text-xl font-bold font-heading mb-2 text-[#06D6A0]">Yaygınlaştırma</h3>
                        <p class="text-gray-600">Mobil üniteleri farklı afet senaryolarında test ederek kentsel alanlara ve okullara entegre etmek.</p>
                    </div>
                    <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-xl transition-shadow">
                        <div class="text-5xl mb-4">🤝</div>
                        <h3 class="text-xl font-bold font-heading mb-2 text-[#FFD166]">Ekonomik Model</h3>
                        <p class="text-gray-600">Biyokütle yan ürünleri için pazar oluşturmak ve karbon kredisi gibi finansman modelleri geliştirmek.</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="bg-[#073B4C] text-white py-8">
        <div class="container mx-auto px-6 text-center">
            <p>&copy; 2025 BIQ-Alg 0CO2 Projesi. Tüm Hakları Saklıdır.</p>
            <p class="text-sm opacity-70 mt-2">Daha Yeşil Bir Gelecek İçin Biyoteknoloji.</p>
        </div>
    </footer>
    
    <div id="message-box" class="message-box"></div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        document.addEventListener('DOMContentLoaded', async function () {
            
            const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
            let db, auth;

            function showMessage(message, duration = 3000) {
                const messageBox = document.getElementById('message-box');
                messageBox.textContent = message;
                messageBox.classList.add('show');
                setTimeout(() => {
                    messageBox.classList.remove('show');
                }, duration);
            }

            try {
                const app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                auth = getAuth(app);
            } catch(e) {
                console.error("Firebase başlatma hatası:", e);
                showMessage("Uygulama başlatılamadı. Lütfen sayfayı yenileyin.");
                return;
            }
            
            onAuthStateChanged(auth, async (user) => {
                if (user) {
                    console.log("Kullanıcı oturum açtı:", user.uid);
                    startRealtimeListeners();
                } else {
                     try {
                        const token = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
                        if (token) {
                            await signInWithCustomToken(auth, token);
                        } else {
                            await signInAnonymously(auth);
                        }
                    } catch (error) {
                        console.error("Kimlik doğrulama hatası:", error);
                        showMessage("Canlı verilere bağlanılamadı.");
                    }
                }
            });

            const pbrPerformanceData = {
                labels: ['Biyokütle Verimliliği (g/L/gün)', 'Maks. Biyokütle Yoğunluğu (g/L)'],
                datasets: [
                    { label: 'Dikey Tübüler FBR', data: [1.65, 20.0], backgroundColor: '#118AB2' },
                    { label: 'Düz Panel FBR', data: [4.8, 26.6], backgroundColor: '#06D6A0' },
                    { label: 'Açık Havuz', data: [0.3, 1.5], backgroundColor: '#FFD166' }
                ]
            };

            const pbrCtx = document.getElementById('pbrPerformanceChart').getContext('2d');
            new Chart(pbrCtx, {
                type: 'bar', data: pbrPerformanceData,
                options: { responsive: true, maintainAspectRatio: false,
                    scales: { y: { beginAtZero: true, title: { display: true, text: 'Değer' } } },
                    plugins: { title: { display: true, text: 'Farklı FBR Teknolojilerinin Performans Karşılaştırması' } }
                }
            });

            const createChart = (ctx, type, datasets, title) => {
                return new Chart(ctx, {
                    type: type,
                    data: { labels: [], datasets: datasets },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        scales: {
                            x: { type: 'time', time: { unit: 'second', displayFormats: { second: 'HH:mm:ss' } }, ticks: { maxRotation: 0, minRotation: 0, autoSkip: true, maxTicksLimit: 7 }},
                            y: { beginAtZero: true }
                        },
                        plugins: { legend: { display: true }, title: { display: false } }
                    }
                });
            };
            
            const tempHumidityCtx = document.getElementById('tempHumidityChart').getContext('2d');
            const co2Ctx = document.getElementById('co2Chart').getContext('2d');

            const tempHumidityChart = createChart(tempHumidityCtx, 'line', [
                { label: 'Sıcaklık (°C)', data: [], borderColor: '#FF6B6B', tension: 0.1 },
                { label: 'Nem (%)', data: [], borderColor: '#118AB2', tension: 0.1 }
            ]);
            const co2Chart = createChart(co2Ctx, 'line', [
                { label: 'CO₂ (ppm)', data: [], borderColor: '#06D6A0', tension: 0.1, fill: { target: 'origin', above: 'rgba(6, 214, 160, 0.1)'} }
            ]);

            function updateChart(chart, newData) {
                const maxDataPoints = 30;
                if (chart.data.labels.length >= maxDataPoints) {
                    chart.data.labels.shift();
                    chart.data.datasets.forEach(dataset => dataset.data.shift());
                }
                chart.data.labels.push(newData.x);
                newData.y.forEach((yValue, index) => {
                    chart.data.datasets[index].data.push(yValue);
                });
                chart.update();
            }

            function startRealtimeListeners() {
                // *** DÜZELTME: Sabit ve doğru belge yolunu dinle ***
                const liveDataRef = doc(db, "artifacts/default-app-id/public/data/sensors/current_data");
                
                onSnapshot(liveDataRef, (docSnap) => {
                    if (docSnap.exists()) {
                        const data = docSnap.data();
                        
                        // Firestore REST API formatından veri okuma
                        const co2 = data.co2?.integerValue || data.co2?.doubleValue || '---';
                        const mq135 = data.mq135_value?.integerValue || data.mq135_value?.doubleValue || '---';
                        const light = data.light_value?.integerValue || data.light_value?.doubleValue || '---';
                        const temp = data.temperature?.doubleValue || data.temperature?.integerValue || '--';
                        const hum = data.humidity?.doubleValue || data.humidity?.integerValue || '--';
                        const timestamp = data.timestamp?.timestampValue ? new Date(data.timestamp.timestampValue) : new Date();

                        // KPI'ları güncelle
                        document.getElementById('kpi-co2').innerHTML = `${co2} <span class="text-lg">ppm</span>`;
                        document.getElementById('kpi-mq135').textContent = mq135 !== '---' ? (parseInt(mq135) < 300 ? 'İyi' : 'Kontrol') : '---';
                        document.getElementById('kpi-light').innerHTML = `${light} <span class="text-lg">lux</span>`;
                        document.getElementById('kpi-temp').innerHTML = `${parseFloat(temp).toFixed(1)} <span class="text-lg">°C</span>`;
                        document.getElementById('kpi-humidity').innerHTML = `${parseFloat(hum).toFixed(1)} <span class="text-lg">%</span>`;

                        // Grafikleri güncelle
                        updateChart(tempHumidityChart, { x: timestamp, y: [temp, hum] });
                        updateChart(co2Chart, { x: timestamp, y: [co2] });

                    } else {
                        showMessage("Canlı veri kaynağı bekleniyor... Cihazın veri gönderdiğinden emin olun.", 5000);
                    }
                }, (error) => {
                    console.error("Firebase dinleme hatası:", error);
                    showMessage("Canlı veri akışında bir sorun oluştu.");
                });
            }

            const navLinks = document.querySelectorAll('.nav-link');
            const sections = document.querySelectorAll('main section');

            window.addEventListener('scroll', () => {
                let current = 'hero';
                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    if (window.pageYOffset >= sectionTop - 75) {
                        current = section.getAttribute('id');
                    }
                });

                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.href.includes(current)) {
                        link.classList.add('active');
                    }
                });
            });
        });
    </script>
</body>
</html>
