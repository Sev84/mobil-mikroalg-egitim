<!DOCTYPE html>
<html lang="tr" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BIQ-Alg 0CO2: Afet BÃ¶lgesi Hava Ä°stasyonu</title>
    <!-- SeÃ§ilen Palet: Mavi-YeÅŸil Uyum (AÃ§Ä±k mavi, koyu teal, Ã§elik mavisi, deniz yeÅŸili) -->
    <!-- Uygulama YapÄ±sÄ± PlanÄ±: SPA, kullanÄ±cÄ±yÄ± temel sorundan (afet sonrasÄ± hava kirliliÄŸi) Ã§Ã¶zÃ¼me (mikroalgler) ve bunun daha geniÅŸ etkilerine yÃ¶nlendiren tematik, doÄŸrusal olmayan bir yapÄ± kullanÄ±r. YÃ¼ksek seviyeli bir giriÅŸle baÅŸlar, ardÄ±ndan teknoloji karÅŸÄ±laÅŸtÄ±rmasÄ±na (interaktif FBR grafiÄŸi) dalar, Ã§eÅŸitli uygulamalarÄ± (baÅŸka bir grafik iÃ§eren sekmeli gÃ¶rÃ¼nÃ¼m) keÅŸfeder ve son olarak katma deÄŸer yÃ¶nlerini (dÃ¶ngÃ¼sel ekonomi diyagramÄ±, STEM proje kartlarÄ±) ve gelecek gÃ¶rÃ¼nÃ¼mÃ¼nÃ¼ kapsar. Yeni bir "CanlÄ± SensÃ¶r Verileri" bÃ¶lÃ¼mÃ¼, Firebase Firestore'dan gerÃ§ek zamanlÄ± sensÃ¶r verilerini okumak ve gÃ¶rÃ¼ntÃ¼lemek iÃ§in eklenmiÅŸtir; ÅŸimdi MQ135 (hava kalitesi), IÅŸÄ±k, SÄ±caklÄ±k ve Nem sensÃ¶rlerini iÃ§erir. AyrÄ±ca, sensÃ¶r verilerini grafiksel olarak gÃ¶rselleÅŸtirme ve CSV olarak dÄ±ÅŸa aktarma Ã¶zellikleri eklenmiÅŸtir. Bu istasyon, afetzedeler iÃ§in hem deneyimsel Ã¶ÄŸrenme hem de temiz hava saÄŸlayan bir Ã§Ã¶zÃ¼m olarak tasarlanmÄ±ÅŸtÄ±r. Bu versiyon ayrÄ±ca TÃ¼rkiye'deki farklÄ± deprem bÃ¶lgelerinden simÃ¼le edilmiÅŸ atmosfer verilerini karÅŸÄ±laÅŸtÄ±rma yeteneÄŸi de iÃ§erir. -->
    <!-- GÃ¶rselleÅŸtirme ve Ä°Ã§erik SeÃ§imleri: FBR'ler: AmaÃ§=KarÅŸÄ±laÅŸtÄ±r -> GÃ¶rselleÅŸtirme=Ã‡ubuk Grafik (Chart.js) -> EtkileÅŸim=Grafik/metni gÃ¼ncellemek iÃ§in dÃ¼ÄŸmeler. Mobil Sistemler: AmaÃ§=KarÅŸÄ±laÅŸtÄ±r -> GÃ¶rselleÅŸtirme=Ã‡ubuk Grafik (Chart.js). DÃ¶ngÃ¼sel Ekonomi: AmaÃ§=Organize Et/AÃ§Ä±klla -> GÃ¶rselleÅŸtirme=HTML/CSS DiyagramÄ±. STEM Projeleri: AmaÃ§=Bilgilendir/Organize Et -> GÃ¶rselleÅŸtirme=Ä°nteraktif Kartlar. CanlÄ± SensÃ¶r Verileri: AmaÃ§=Bilgilendir/Ä°zle -> GÃ¶rselleÅŸtirme=Dinamik metin geri bildirimi iÃ§eren HTML/JS sayÄ±sal ekran ve Chart.js ile Ã§izelgeler, Firebase Firestore'dan veri Ã§ekme (MQ135, IÅŸÄ±k, SÄ±caklÄ±k, Nem). GerekÃ§e=Ã–ÄŸrenme iÃ§in gerÃ§ek zamanlÄ± veri etkileÅŸimi. TÃ¼m seÃ§imler SVG/Mermaid kullanÄ±mÄ±ndan kaÃ§Ä±nÄ±r, Ã§izelgeler iÃ§in Canvas ve diyagramlar iÃ§in yapÄ±landÄ±rÄ±lmÄ±ÅŸ HTML/CSS kullanÄ±r. -->
    <!-- ONAYLAMA: SVG grafikleri kullanÄ±lmamÄ±ÅŸtÄ±r. NO Mermaid JS used. -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Open Sans', sans-serif;
            background-color: #F0F8FF; /* Alice Blue - Ã‡ok AÃ§Ä±k Mavi */
            color: #004D40; /* Dark Teal - Koyu Teal */
        }
        h1, h2, h3, h4, .font-heading {
            font-family: 'Montserrat', sans-serif;
            color: #004D40; /* Dark Teal - Koyu Teal */
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .active-nav {
            color: #4682B4; /* Steel Blue - Ã‡elik Mavisi */
            font-weight: bold;
            border-bottom: 2px solid #4682B4;
        }
        .inactive-nav {
            color: #98D8C8; /* Light Teal - AÃ§Ä±k Teal */
        }
        .active-btn {
            background-color: #4682B4; /* Steel Blue - Ã‡elik Mavisi */
            color: #F0F8FF; /* Alice Blue - Ã‡ok AÃ§Ä±k Mavi */
        }
        .inactive-btn {
            background-color: #98D8C8; /* Light Teal - AÃ§Ä±k Teal */
            color: #004D40; /* Dark Teal - Koyu Teal */
        }
        .message-box {
            background-color: #004D40; /* Dark Teal - Koyu Teal */
            color: #F0F8FF; /* Alice Blue - Ã‡ok AÃ§Ä±k Mavi */
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            text-align: center;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            pointer-events: none;
        }
        .message-box.show {
            opacity: 1;
            pointer-events: auto;
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-[#F0F8FF]/80 backdrop-blur-md sticky top-0 z-50 shadow-sm">
        <nav class="container mx-auto px-6 py-3">
            <div class="flex justify-between items-center">
                <a href="#hero" class="text-xl font-bold font-heading text-[#4682B4] flex items-center">
                    <img src="logo111.png" onerror="this.onerror=null; this.src='https://placehold.co/40x40/E0F2F7/1A535C?text=Logo';" alt="BioAlg Logosu" class="h-8 md:h-10 w-auto mr-2 inline-block align-middle">
                    BIQ-Alg 0CO2: Hava Ä°stasyonu
                </a>
                <div class="hidden md:flex space-x-8">
                    <a href="#problem" class="inactive-nav hover:text-[#4682B4] transition-colors">Sorun ve Ã‡Ã¶zÃ¼m</a>
                    <a href="#technology" class="inactive-nav hover:text-[#4682B4] transition-colors">Teknolojiler</a>
                    <a href="#applications" class="inactive-nav hover:text-[#4682B4] transition-colors">Uygulamalar</a>
                    <a href="#value" class="inactive-nav hover:text-[#4682B4] transition-colors">Katma DeÄŸer</a>
                    <a href="#sensors" class="active-nav hover:text-[#4682B4] transition-colors">Ä°zleme ve Uygulama</a>
                    <a href="#future" class="inactive-nav hover:text-[#4682B4] transition-colors">Gelecek</a>
                </div>
            </div>
        </nav>
    </header>

    <main>
        <section id="hero" class="py-20 md:py-32 bg-[#D6EDF7]"> <!-- Hafif Mavi/YeÅŸil Arka Plan -->
            <div class="container mx-auto px-6 text-center">
                <h1 class="text-4xl md:text-6xl font-bold font-heading text-[#004D40] mb-4">Temiz Nefes, Umut YeÅŸertir: Afet BÃ¶lgelerinde Ã‡evre Dostu Hava Ä°stasyonu</h1>
                <p class="text-lg md:text-xl text-[#2E8B57] max-w-3xl mx-auto">
                    Afetzedeler iÃ§in anÄ±nda temiz hava ve sÃ¼rdÃ¼rÃ¼lebilir yaÅŸam Ã§Ã¶zÃ¼mleri sunan mobil mikroalg teknolojisini keÅŸfedin. Bu eÄŸitim istasyonu, hem Ã§evresel bilinci artÄ±racak hem de pratik hava arÄ±tma saÄŸlayacaktÄ±r.
                </p>
            </div>
        </section>

        <section id="problem" class="py-16 md:py-24">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold font-heading text-[#004D40]">Sorun: GÃ¶rÃ¼nmez Tehlike ve GÃ¼Ã§lÃ¼ Ã‡Ã¶zÃ¼m</h2>
                    <p class="mt-4 text-lg text-[#2E8B57] max-w-3xl mx-auto">
                        Afetler sonrasÄ± ortaya Ã§Ä±kan toz, partikÃ¼l madde ve sera gazlarÄ±, halk saÄŸlÄ±ÄŸÄ±nÄ± tehdit eder. Geleneksel yÃ¶ntemler yetersiz kalÄ±rken, doÄŸanÄ±n en verimli fotosentez makineleri olan mikroalgler, bu soruna umut vadeden bir Ã§Ã¶zÃ¼m sunuyor.
                    </p>
                </div>
                <div class="grid md:grid-cols-2 gap-8 items-center">
                    <div class="bg-white p-8 rounded-lg shadow-lg border border-gray-200">
                        <h3 class="text-2xl font-bold font-heading text-[#98D8C8] mb-3">Geleneksel YÃ¶ntemler</h3>
                        <p class="text-[#2E8B57]">Genellikle reaktif (kirlilik oluÅŸtuktan sonra mÃ¼dahale eden), enerji yoÄŸun ve sadece partikÃ¼l filtrelemeye odaklÄ±dÄ±r. Karbon yakalama veya oksijen Ã¼retme yetenekleri yoktur.</p>
                    </div>
                    <div class="bg-[#4682B4] p-8 rounded-lg shadow-lg text-white"> <!-- Ã‡elik Mavisi -->
                        <h3 class="text-2xl font-bold font-heading text-white mb-3">Mikroalg YaklaÅŸÄ±mÄ±</h3>
                        <p>Karasal bitkilerden <span class="font-bold text-2xl">10-50 kat</span> daha verimli COâ‚‚ yakalama kapasitesine sahiptir. Hem havayÄ± temizler, hem oksijen Ã¼retir, hem de deÄŸerli biyokÃ¼tle oluÅŸturur.</p>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="technology" class="py-16 md:py-24 bg-[#D6EDF7]"> <!-- Hafif Mavi/YeÅŸil Arka Plan -->
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold font-heading text-[#004D40]">Teknolojiyi KeÅŸfedin: FotobiyoreaktÃ¶r (FBR) Sistemleri</h2>
                    <p class="mt-4 text-lg text-[#2E8B57] max-w-3xl mx-auto">
                        Mikroalgleri yetiÅŸtirmek ve verimliliklerini en Ã¼st dÃ¼zeye Ã§Ä±karmak iÃ§in farklÄ± teknolojiler kullanÄ±lÄ±r. AÅŸaÄŸÄ±daki butonlara tÄ±klayarak temel FBR tasarÄ±mlarÄ±nÄ±, Ã¶zelliklerini ve COâ‚‚ yakalama verimliliklerini karÅŸÄ±laÅŸtÄ±rÄ±n.
                    </p>
                </div>
                <div class="text-center mb-8 space-x-2 space-y-2">
                    <button id="btn-pbr-1" class="pbr-btn active-btn px-4 py-2 rounded-md font-semibold transition-colors">AÃ§Ä±k Havuzlar</button>
                    <button id="btn-pbr-2" class="pbr-btn inactive-btn px-4 py-2 rounded-md font-semibold transition-colors">TÃ¼bÃ¼ler FBR</button>
                    <button id="btn-pbr-3" class="pbr-btn inactive-btn px-4 py-2 rounded-md font-semibold transition-colors">DÃ¼z Panel FBR</button>
                    <button id="btn-pbr-4" class="pbr-btn inactive-btn px-4 py-2 rounded-md font-semibold transition-colors">KabarcÄ±k Kolon FBR</button>
                </div>
                <div class="grid md:grid-cols-2 gap-8 items-center">
                    <div id="pbr-info-card" class="bg-white p-8 rounded-lg shadow-lg transition-opacity duration-500 border border-gray-200">
                        <h3 id="pbr-title" class="text-2xl font-bold font-heading mb-4 text-[#004D40]">AÃ§Ä±k Havuzlar</h3>
                        <div id="pbr-description" class="text-[#2E8B57]">
                            <p class="mb-2"><strong class="text-[#2E8B57]">AvantajlarÄ±:</strong> DÃ¼ÅŸÃ¼k kurulum maliyeti, bÃ¼yÃ¼k Ã¶lÃ§ekli endÃ¼striyel bÃ¼yÃ¼me iÃ§in uygun.</p><p><strong class="text-[#2E8B57]">DezavantajlarÄ±:</strong> GeniÅŸ alan gereksinimi, dengesiz kÃ¼ltÃ¼r koÅŸullarÄ±, kirlilik riski.</p>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="pbrChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <section id="applications" class="py-16 md:py-24">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold font-heading text-[#004D40]">GeniÅŸ Uygulama AlanlarÄ±</h2>
                    <p class="mt-4 text-lg text-[#2E8B57] max-w-3xl mx-auto">
                        Mikroalg teknolojisi, endÃ¼striyel bacalardan evimizdeki havaya kadar Ã§ok Ã§eÅŸitli alanlarda devrim yaratma potansiyeline sahiptir. Ã–zellikle taÅŸÄ±nabilir sistemler, afet bÃ¶lgelerinde hÄ±zlÄ± ve etkili Ã§Ã¶zÃ¼mler sunar.
                    </p>
                </div>
                <div class="grid md:grid-cols-2 gap-8 items-start">
                    <div class="space-y-6">
                         <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200">
                            <h3 class="text-xl font-bold font-heading mb-2 text-[#004D40]">EndÃ¼striyel Ã–lÃ§ek</h3>
                            <p class="text-[#2E8B57]">Enerji santralleri ve fabrikalarÄ±n baca gazlarÄ±ndan COâ‚‚'yi yakalayarak hem Ã§evresel etkiyi azaltÄ±r hem de deÄŸerli biyokÃ¼tle Ã¼retir.</p>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200">
                            <h3 class="text-xl font-bold font-heading mb-2 text-[#004D40]">Ä°Ã§ Mekan Hava Kalitesi</h3>
                            <p class="text-[#2E8B57]">Ev ve ofislerde COâ‚‚ seviyelerini dÃ¼ÅŸÃ¼rÃ¼r, oksijen Ã¼retir ve estetik bir "biyofilik" tasarÄ±m Ã¶ÄŸesi olarak insan psikolojisini olumlu etkiler.</p>
                        </div>
                         <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200">
                            <h3 class="text-xl font-bold font-heading mb-2 text-[#004D40]">Mobil ve Afet Ã‡Ã¶zÃ¼mleri</h3>
                            <p class="text-[#2E8B57]">BIQ-Alg 0CO2 gibi taÅŸÄ±nabilir, modÃ¼ler ve enerji verimli sistemler, afet sonrasÄ± geÃ§ici barÄ±naklarda ve kriz bÃ¶lgelerinde hÄ±zla devreye alÄ±nabilir.</p>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200">
                         <h3 class="text-xl text-center font-bold font-heading mb-4 text-[#004D40]">TaÅŸÄ±nabilir Sistemlerin PerformansÄ±</h3>
                         <div class="chart-container h-96">
                            <canvas id="mobileSystemsChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="value" class="py-16 md:py-24 bg-[#D6EDF7]"> <!-- Hafif Mavi/YeÅŸil Arka Plan -->
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold font-heading text-[#004D40]">Teknolojinin Ã–tesi: Katma DeÄŸer</h2>
                    <p class="mt-4 text-lg text-[#2E8B57] max-w-3xl mx-auto">
                        Mikroalg sistemleri sadece havayÄ± temizlemekle kalmaz; dÃ¶ngÃ¼sel ekonomi ve eÄŸitim alanlarÄ±nda da Ã¶nemli faydalar saÄŸlar.
                    </p>
                </div>
                <div class="grid md:grid-cols-2 gap-12">
                    <div>
                        <h3 class="text-2xl font-bold font-heading mb-6 text-center text-[#004D40]">DÃ¶ngÃ¼sel Ekonomi: AtÄ±ktan DeÄŸere</h3>
                        <div class="flex flex-col md:flex-row items-center justify-center space-y-4 md:space-y-0 md:space-x-4">
                            <div class="text-center p-4 bg-white rounded-lg shadow">
                                <p class="font-bold text-lg font-heading text-[#2E8B57]">GÄ°RDÄ°</p>
                                <p class="text-[#98D8C8]">Atmosferik COâ‚‚</p>
                                <p class="text-[#98D8C8]">AtÄ±k Su Besinleri</p>
                            </div>
                            <div class="text-2xl font-bold text-[#2E8B57] transform md:-rotate-0 rotate-90">&rarr;</div>
                             <div class="text-center p-4 bg-[#4682B4] rounded-lg shadow text-white"> <!-- Ã‡elik Mavisi -->
                                <p class="font-bold text-lg font-heading">SÃœREÃ‡</p>
                                <p>Mikroalg Fotosentezi</p>
                            </div>
                            <div class="text-2xl font-bold text-[#2E8B57] transform md:-rotate-0 rotate-90">&rarr;</div>
                            <div class="text-center p-4 bg-white rounded-lg shadow">
                                <p class="font-bold text-lg font-heading text-[#2E8B57]">Ã‡IKTI (BiyokÃ¼tle)</p>
                                <p class="text-[#98D8C8]">BiyoyakÄ±t & GÃ¼bre</p>
                                <p class="text-[#98D8C8]">Hayvan Yemi & GÄ±da</p>
                            </div>
                        </div>
                    </div>
                     <div>
                        <h3 class="text-2xl font-bold font-heading mb-6 text-center text-[#004D40]">EÄŸitim ve STEM FarkÄ±ndalÄ±ÄŸÄ±</h3>
                        <div id="stem-projects-container" class="space-y-4">
                            <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow">
                                <h4 class="font-bold text-[#2E8B57]">UygulamalÄ± Ã–ÄŸrenme</h4>
                                <p class="text-sm text-[#98D8C8]">Ã–ÄŸrenciler, "Alglerden Ä°p YapÄ±mÄ±" veya "Kendin Yap GÃ¼neÅŸ FÄ±rÄ±nÄ±" gibi projelerle sÃ¼rdÃ¼rÃ¼lebilirlik kavramlarÄ±nÄ± somut olarak deneyimler.</p>
                            </div>
                            <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow">
                                <h4 class="font-bold text-[#2E8B57]">Teknoloji Entegrasyonu</h4>
                                <p class="text-sm text-[#98D8C8]">IoT sensÃ¶rleri ile sistem verilerini izlemek, Ã¶ÄŸrencilere veri analizi ve mÃ¼hendislik becerileri kazandÄ±rÄ±r.</p>
                            </div>
                        </div>
                        
                        <div class="mt-8 p-6 bg-white rounded-lg shadow-lg border border-gray-200">
                            <h4 class="text-xl font-bold font-heading mb-4 text-[#004D40]">Kendi Projenizi Ekleyin!</h4>
                            <div class="mb-4">
                                <label for="project-title" class="block text-sm font-medium text-[#2E8B57] mb-1">Proje BaÅŸlÄ±ÄŸÄ±:</label>
                                <input type="text" id="project-title" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#98D8C8]" placeholder="Ã–rn: Evde AtÄ±k Su ArÄ±tma Projesi">
                            </div>
                            <div class="mb-4">
                                <label for="project-description" class="block text-sm font-medium text-[#2E8B57] mb-1">Proje AÃ§Ä±klamasÄ±:</label>
                                <textarea id="project-description" rows="3" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#98D8C8]" placeholder="Projenin kÄ±sa bir aÃ§Ä±klamasÄ±nÄ± girin..."></textarea>
                            </div>
                            <button id="add-project-btn" class="active-btn px-6 py-2 rounded-md font-semibold transition-colors w-full">Proje Ekle</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="sensors" class="py-16 md:py-24">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold font-heading text-[#004D40]">CanlÄ± SensÃ¶r Verileri ve Ä°stasyon Ä°zleme</h2>
                    <p class="mt-4 text-lg text-[#2E8B57] max-w-3xl mx-auto">
                        Bu bÃ¶lÃ¼m, BIQ-Alg 0CO2 hava istasyonunun canlÄ± Ã§evresel verilerini ve donanÄ±m bileÅŸenlerinin durumunu gÃ¶stermektedir. Veriler, ESP32 DevKitC kartÄ± ve entegre sensÃ¶rlerden gerÃ§ek zamanlÄ± olarak alÄ±nmaktadÄ±r. Afetzedeler iÃ§in temiz hava saÄŸlayan bu eÄŸitim istasyonu, hem bir izleme monitÃ¶rÃ¼ hem de uygulamalÄ± bir Ã¶ÄŸrenme platformu olarak kullanÄ±lacaktÄ±r.
                        <br><br>
                        Ä°stasyonda bulunan sensÃ¶rler ve aktÃ¼atÃ¶rler: **DS18B20 SÄ±caklÄ±k SensÃ¶rÃ¼**, **MQ-135 Gaz SensÃ¶rÃ¼**, **TSL2591 (veya BH1750) IÅŸÄ±k SensÃ¶rÃ¼**. AyrÄ±ca, sistem durumunu gÃ¶steren bir **OLED Ekran**, otomasyon iÃ§in **RÃ¶le ModÃ¼lÃ¼** ve test amaÃ§lÄ± bir **Servo Motor** (pompa yerine) ESP32 DevKitC kartÄ±na baÄŸlÄ±dÄ±r. Web uygulamasÄ±, bu fiziksel bileÅŸenlerin durumunu ve sensÃ¶r okumalarÄ±nÄ± izler, ancak doÄŸrudan kontrol saÄŸlamaz.
                    </p>
                </div>

                <!-- Veri GÃ¶rÃ¼nÃ¼mÃ¼ SeÃ§ici -->
                <div class="flex flex-col md:flex-row justify-center items-center gap-4 mb-8">
                    <div class="flex items-center space-x-2">
                        <label for="data-view-mode" class="text-lg font-semibold text-[#004D40]">Veri GÃ¶rÃ¼nÃ¼mÃ¼:</label>
                        <select id="data-view-mode" class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4682B4]">
                            <option value="live">CanlÄ± Ä°stasyon Verisi</option>
                            <option value="historical">GeÃ§miÅŸ BÃ¶lgesel Veriler</option>
                        </select>
                    </div>
                    <div id="region-select-container" class="flex items-center space-x-2 hidden">
                        <label for="region-select" class="text-lg font-semibold text-[#004D40]">BÃ¶lge SeÃ§in:</label>
                        <select id="region-select" class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4682B4]">
                            <!-- BÃ¶lgeler JavaScript tarafÄ±ndan doldurulacak -->
                        </select>
                    </div>
                </div>

                <!-- SayÄ±sal SensÃ¶r DeÄŸerleri -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="bg-white p-6 rounded-lg shadow-lg text-center border border-gray-200">
                        <h3 class="text-xl font-bold font-heading text-[#2E8B57]">COâ‚‚ Seviyesi</h3>
                        <p id="co2-value" class="text-4xl font-bold text-[#004D40] mt-2">-- ppm</p>
                    </div>
                     <div class="bg-white p-6 rounded-lg shadow-lg text-center border border-gray-200">
                        <h3 class="text-xl font-bold font-heading text-[#2E8B57]">Hava Kalitesi (MQ135)</h3>
                        <p id="mq135-value" class="text-4xl font-bold text-[#004D40] mt-2">-- mV</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg text-center border border-gray-200">
                        <h3 class="text-xl font-bold font-heading text-[#2E8B57]">IÅŸÄ±k Åiddeti (TSL2591/BH1750)</h3>
                        <p id="light-value" class="text-4xl font-bold text-[#004D40] mt-2">-- lux</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg text-center border border-gray-200">
                        <h3 class="text-xl font-bold font-heading text-[#2E8B57]">SÄ±caklÄ±k (DS18B20) ve Nem</h3>
                        <p id="temp-value" class="text-4xl font-bold text-[#004D40] mt-2">-- Â°C</p>
                        <p id="humidity-value" class="text-4xl font-bold text-[#004D40] mt-2">-- %</p>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200 text-center mb-8">
                    <h3 class="text-xl font-bold font-heading text-[#004D40] mb-4">Sistem Durumu MesajÄ±</h3>
                    <p id="status-message" class="text-lg text-[#2E8B57]">SensÃ¶r verileri yÃ¼kleniyor...</p>
                </div>

                <!-- Grafiksel SensÃ¶r Verileri -->
                <div class="text-center mb-8">
                    <h3 class="text-2xl font-bold font-heading text-[#004D40] mb-4">Veri Grafikleri (Son 30 Okuma)</h3>
                    <button id="download-csv-btn" class="active-btn px-6 py-2 rounded-md font-semibold transition-colors">Verileri CSV Olarak Ä°ndir</button>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200">
                        <h4 class="text-lg font-bold font-heading text-[#2E8B57] mb-4 text-center">COâ‚‚ Seviyesi Trendi</h4>
                        <div class="chart-container">
                            <canvas id="co2ChartCanvas"></canvas>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200">
                        <h4 class="text-lg font-bold font-heading text-[#2E8B57] mb-4 text-center">Hava Kalitesi (MQ135) Trendi</h4>
                        <div class="chart-container">
                            <canvas id="mq135ChartCanvas"></canvas>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200">
                        <h4 class="text-lg font-bold font-heading text-[#2E8B57] mb-4 text-center">IÅŸÄ±k Åiddeti Trendi</h4>
                        <div class="chart-container">
                            <canvas id="lightChartCanvas"></canvas>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200">
                        <h4 class="text-lg font-bold font-heading text-[#2E8B57] mb-4 text-center">SÄ±caklÄ±k ve Nem Trendi</h4>
                        <div class="chart-container">
                            <canvas id="tempHumidityChartCanvas"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="future" class="py-16 md:py-24">
             <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold font-heading text-[#004D40]">Gelecek Vizyonu ve Ã–neriler</h2>
                     <p class="mt-4 text-lg text-[#2E8B57] max-w-3xl mx-auto">
                        Bu teknolojinin potansiyelini tam olarak hayata geÃ§irmek iÃ§in stratejik adÄ±mlar atÄ±lmalÄ±dÄ±r.
                    </p>
                </div>
                <div class="grid md:grid-cols-3 gap-8 text-center">
                    <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200">
                        <div class="text-4xl mb-4 text-[#2E8B57]">âš™ï¸</div> <!-- Deniz YeÅŸili -->
                        <h3 class="text-xl font-bold font-heading mb-2">Teknoloji GeliÅŸtirme</h3>
                        <p class="text-[#2E8B57]">Daha dayanÄ±klÄ± alg tÃ¼rleri araÅŸtÄ±rmak, FBR tasarÄ±mlarÄ±nÄ± optimize etmek ve maliyetleri dÃ¼ÅŸÃ¼rmek.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200">
                        <div class="text-4xl mb-4 text-[#4682B4]">ğŸŒ</div> <!-- Ã‡elik Mavisi -->
                        <h3 class="text-xl font-bold font-heading mb-2">Saha UygulamalarÄ±</h3>
                        <p class="text-[#2E8B57]">Mobil Ã¼nitelerin afet senaryolarÄ±nda test edilmesi ve mevcut altyapÄ±larla entegrasyonu.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200">
                        <div class="text-4xl mb-4 text-[#98D8C8]">ğŸ¤</div> <!-- AÃ§Ä±k Teal -->
                        <h3 class="text-xl font-bold font-heading mb-2">Ekonomik SÃ¼rdÃ¼rÃ¼lebilirlik</h3>
                        <p class="text-[#2E8B57]">BiyokÃ¼tle yan Ã¼rÃ¼nlerinin pazarÄ±nÄ± geliÅŸtirmek ve yatÄ±rÄ±m iÃ§in yeni finansman modelleri oluÅŸturmak.</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="bg-[#004D40] text-[#F0F8FF] py-8"> <!-- Koyu Teal Arka Plan -->
        <div class="container mx-auto px-6 text-center">
            <p>&copy; 2025 BIQ-Alg 0CO2: Hava Kalitesi EÄŸitim Ä°stasyonu. Ã‡evre Dostu ve SÃ¼rdÃ¼rÃ¼lebilir Ã‡Ã¶zÃ¼m.</p>
            <p class="text-sm text-[#98D8C8] mt-2">Bu uygulama, BIQ-Alg 0CO2 projesi kapsamÄ±nda geliÅŸtirilmiÅŸtir.</p>
        </div>
    </footer>

    <div id="message-box" class="message-box">
        <p id="message-text"></p>
    </div>

    <script type="module">
        // Firebase SDK'larÄ±nÄ± iÃ§e aktarÄ±n
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        // Gerekli tÃ¼m Firestore modÃ¼llerini ekleyin
        import { getFirestore, doc, onSnapshot, collection, query, limit, orderBy, setDoc, getDocs } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        document.addEventListener('DOMContentLoaded', function () {
            
            // Mevcut pbrData ve pbrInfo tanÄ±mlamalarÄ±...
            const pbrData = {
                labels: ['COâ‚‚ Fiksasyon VerimliliÄŸi (%)'],
                datasets: [
                    { label: 'AÃ§Ä±k Havuzlar', data: [90], backgroundColor: '#98D8C8' }, /* Light Teal */
                    { label: 'TÃ¼bÃ¼ler FBR', data: [76], backgroundColor: '#4682B4', hidden: true }, /* Steel Blue */
                    { label: 'DÃ¼z Panel FBR', data: [85], backgroundColor: '#2E8B57', hidden: true }, /* Sea Green */
                    { label: 'KabarcÄ±k Kolon FBR', data: [90], backgroundColor: '#004D40', hidden: true } /* Dark Teal */
                ]
            };
            
            const pbrInfo = {
                'btn-pbr-1': { title: 'AÃ§Ä±k Havuzlar', description: '<p class="mb-2"><strong class="text-[#2E8B57]">AvantajlarÄ±:</strong> DÃ¼ÅŸÃ¼k kurulum maliyeti, bÃ¼yÃ¼k Ã¶lÃ§ekli endÃ¼striyel bÃ¼yÃ¼me iÃ§in uygun.</p><p><strong class="text-[#2E8B57]">DezavantajlarÄ±:</strong> GeniÅŸ alan gereksinimi, dengesiz kÃ¼ltÃ¼r koÅŸullarÄ±, kirlilik riski.</p>' },
                'btn-pbr-2': { title: 'TÃ¼bÃ¼ler FBR', description: '<p class="mb-2"><strong class="text-[#2E8B57]">AvantajlarÄ±:</strong> Aseptik Ã§alÄ±ÅŸma, stabil koÅŸullar, su buharlaÅŸmasÄ±nÄ± Ã¶nler, mimari entegrasyon potansiyeli.</p><p><strong class="text-[#2E8B57]">DezavantajlarÄ±:</strong> YÃ¼ksek inÅŸaat ve iÅŸletme maliyetleri.</p>' },
                'btn-pbr-3': { title: 'DÃ¼z Panel FBR', description: '<p class="mb-2"><strong class="text-[#2E8B57]">AvantajlarÄ±:</strong> OlaÄŸanÃ¼stÃ¼ COâ‚‚ emilimi, optimize edilmiÅŸ mikroalg bÃ¼yÃ¼mesi, yÃ¼ksek karbon tutulumu.</p><p><strong class="text-[#2E8B57]">DezavantajlarÄ±:</strong> YÃ¼ksek teknoloji gereksinimi.</p>' },
                'btn-pbr-4': { title: 'KabarcÄ±k Kolon FBR', description: '<p class="mb-2"><strong class="text-[#2E8B57]">AvantajlarÄ±:</strong> SÄ±caklÄ±k kontrolÃ¼, dÃ¼ÅŸÃ¼k basÄ±nÃ§ dÃ¼ÅŸÃ¼ÅŸÃ¼, yÃ¼ksek arayÃ¼zey alanÄ±.</p><p><strong class="text-[#2E8B57]">DezavantajlarÄ±:</strong> YÃ¼ksek konsantrasyonlarda etkilidir, daha karmaÅŸÄ±k yapÄ±.</p>' }
            };

            const pbrCtx = document.getElementById('pbrChart').getContext('2d');
            const pbrChart = new Chart(pbrCtx, {
                type: 'bar',
                data: pbrData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            title: { display: true, text: 'Verimlilik (%)' }
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: ${context.raw}%`;
                                }
                            }
                        }
                    }
                }
            });

            const pbrButtons = document.querySelectorAll('.pbr-btn');
            pbrButtons.forEach((button, index) => {
                button.addEventListener('click', () => {
                    pbrButtons.forEach(btn => {
                        btn.classList.remove('active-btn');
                        btn.classList.add('inactive-btn');
                    });
                    button.classList.add('active-btn');
                    button.classList.remove('inactive-btn');

                    pbrChart.data.datasets.forEach((dataset, i) => {
                        dataset.hidden = (i !== index);
                    });
                    pbrChart.update();
                    
                    const info = pbrInfo[button.id];
                    document.getElementById('pbr-title').innerText = info.title;
                    document.getElementById('pbr-description').innerHTML = info.description;
                });
            });

            const mobileSystemsData = {
                labels: ['aerium', 'Vayu', 'Liquid 3'],
                datasets: [{
                    label: 'EÅŸdeÄŸer Ev Bitkisi/AÄŸaÃ§ SayÄ±sÄ±',
                    data: [25, 40, 200], 
                    backgroundColor: ['#98D8C8', '#4682B4', '#2E8B57'], /* Light Teal, Steel Blue, Sea Green */
                    borderColor: '#F0F8FF', /* Alice Blue */
                    borderWidth: 2
                }]
            };

            const mobileSystemsCtx = document.getElementById('mobileSystemsChart').getContext('2d');
            new Chart(mobileSystemsCtx, {
                type: 'doughnut',
                data: mobileSystemsData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        tooltip: {
                             callbacks: {
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed !== null) {
                                        let value = context.parsed;
                                        if (context.label === 'Liquid 3') {
                                           label += `${value / 100} aÄŸaca eÅŸdeÄŸer`;
                                        } else {
                                           label += `${value} ev bitkisine eÅŸdeÄŸer`;
                                        }
                                    }
                                    return label;
                                }
                            }
                        },
                        title: {
                            display: true,
                            text: 'Performans (EÅŸdeÄŸer Bitki/AÄŸaÃ§ SayÄ±sÄ±)',
                            padding: { top: 10, bottom: 10 }
                        }
                    }
                }
            });
            
            const navLinks = document.querySelectorAll('header nav a');
            const sections = document.querySelectorAll('main section');
            
            window.addEventListener('scroll', () => {
                let current = '';
                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    if (pageYOffset >= sectionTop - 60) {
                        current = section.getAttribute('id');
                    }
                });

                navLinks.forEach(link => {
                    link.classList.remove('active-nav');
                    link.classList.add('inactive-nav');
                    if (link.href.includes(current)) {
                        link.classList.add('active-nav');
                        link.classList.remove('inactive-nav');
                    }
                });
            });

            // STEM Proje Ekleme MantÄ±ÄŸÄ± (DeÄŸiÅŸmedi)
            const addProjectBtn = document.getElementById('add-project-btn');
            const projectTitleInput = document.getElementById('project-title');
            const projectDescriptionInput = document.getElementById('project-description');
            const stemProjectsContainer = document.getElementById('stem-projects-container');
            const messageBox = document.getElementById('message-box');
            const messageText = document.getElementById('message-text');

            function showMessage(message, duration = 3000) {
                messageText.innerText = message;
                messageBox.classList.add('show');
                setTimeout(() => {
                    messageBox.classList.remove('show');
                }, duration);
            }

            addProjectBtn.addEventListener('click', () => {
                const title = projectTitleInput.value.trim();
                const description = projectDescriptionInput.value.trim();

                if (title === '' || description === '') {
                    showMessage('LÃ¼tfen proje baÅŸlÄ±ÄŸÄ± ve aÃ§Ä±klamasÄ±nÄ± girin.');
                    return;
                }

                const newProjectDiv = document.createElement('div');
                newProjectDiv.className = 'bg-white p-4 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow';
                newProjectDiv.innerHTML = `
                    <h4 class="font-bold text-[#2E8B57]">${title}</h4> <!-- Deniz YeÅŸili -->
                    <p class="text-sm text-[#98D8C8]">${description}</p> <!-- AÃ§Ä±k Teal -->
                `;
                stemProjectsContainer.appendChild(newProjectDiv);

                projectTitleInput.value = '';
                projectDescriptionInput.value = '';
                showMessage('Proje baÅŸarÄ±yla eklendi!');
            });

            // SensÃ¶r Veri GÃ¶rÃ¼ntÃ¼leme ElemanlarÄ±
            const co2ValueSpan = document.getElementById('co2-value');
            const mq135ValueSpan = document.getElementById('mq135-value');
            const lightValueSpan = document.getElementById('light-value');
            const tempValueSpan = document.getElementById('temp-value');
            const humidityValueSpan = document.getElementById('humidity-value');
            const statusMessageP = document.getElementById('status-message');
            const dataViewModeSelect = document.getElementById('data-view-mode');
            const regionSelectContainer = document.getElementById('region-select-container');
            const regionSelect = document.getElementById('region-select');

            let currentViewMode = 'live'; // VarsayÄ±lan gÃ¶rÃ¼nÃ¼m modu
            let currentLiveListener = null; // CanlÄ± veri dinleyicisini tutmak iÃ§in

            function updateStatusMessage(co2, mq135, light, temperature, humidity) {
                if (currentViewMode === 'historical') {
                    statusMessageP.innerText = "GeÃ§miÅŸ veriler gÃ¶rÃ¼ntÃ¼leniyor. GerÃ§ek zamanlÄ± sistem durumu mevcut deÄŸil.";
                    return;
                }

                let message = 'Sistem durumu iyi. Mikroalgler aktif olarak Ã§alÄ±ÅŸÄ±yor.';

                // EÄŸer deÄŸerler hala varsayÄ±lan '--' ise yÃ¼kleniyor mesajÄ±nÄ± gÃ¶ster
                if (co2 === '--' || mq135 === '--' || light === '--' || temperature === '--' || humidity === '--') {
                    message = "SensÃ¶r verileri yÃ¼kleniyor veya eksik...";
                } else {
                    // SayÄ±sal deÄŸerler Ã¼zerinden mesajlarÄ± gÃ¼ncelle
                    if (co2 > 800) {
                        message = 'YÃ¼ksek COâ‚‚ seviyesi tespit edildi! Mikroalglerin fotosentezi hÄ±zlanabilir.';
                    } else if (co2 < 400) {
                        message = 'COâ‚‚ seviyesi dÃ¼ÅŸÃ¼k, fotosentez yavaÅŸlayabilir. COâ‚‚ takviyesi dÃ¼ÅŸÃ¼nÃ¼lebilir.';
                    }

                    if (mq135 > 200) { 
                        if (message === 'Sistem durumu iyi. Mikroalgler aktif olarak Ã§alÄ±ÅŸÄ±yor.') { 
                            message = ''; 
                        }
                        message += ' Hava kalitesi dÃ¼ÅŸÃ¼k algÄ±landÄ±, havalandÄ±rma kontrol edilmeli.';
                    }

                    if (light < 100) { 
                         if (message === 'Sistem durumu iyi. Mikroalgler aktif olarak Ã§alÄ±ÅŸÄ±yor.') {
                            message = '';
                        }
                        message += ' IÅŸÄ±k seviyesi dÃ¼ÅŸÃ¼k, fotosentez iÃ§in Ä±ÅŸÄ±k takviyesi dÃ¼ÅŸÃ¼nÃ¼lebilir.';
                    } else if (light > 1000) { 
                         if (message === 'Sistem durumu iyi. Mikroalgler aktif olarak Ã§alÄ±ÅŸÄ±yor.') {
                            message = '';
                        }
                        message += ' IÅŸÄ±k seviyesi yÃ¼ksek, aÅŸÄ±rÄ± Ä±ÅŸÄ±k stresi olabilir.';
                    }

                    if (temperature > 28) {
                        if (message === 'Sistem durumu iyi. Mikroalgler aktif olarak Ã§alÄ±ÅŸÄ±yor.') {
                            message = '';
                        }
                        message += ' SÄ±caklÄ±k yÃ¼ksek, soÄŸutma gerekli olabilir.';
                    } else if (temperature < 22) {
                        if (message === 'Sistem durumu iyi. Mikroalgler aktif olarak Ã§alÄ±ÅŸÄ±yor.') {
                            message = '';
                        }
                        message += ' SÄ±caklÄ±k dÃ¼ÅŸÃ¼k, Ä±sÄ±tma gerekli olabilir.';
                    }

                    if (humidity < 40) {
                        if (message === 'Sistem durumu iyi. Mikroalgler aktif olarak Ã§alÄ±ÅŸÄ±yor.') {
                            message = '';
                        }
                        message += ' Nem seviyesi dÃ¼ÅŸÃ¼k, buharlaÅŸma artabilir.';
                    } else if (humidity > 70) {
                        if (message === 'Sistem durumu iyi. Mikroalgler aktif olarak Ã§alÄ±ÅŸÄ±yor.') {
                            message = '';
                        }
                        message += ' Nem seviyesi yÃ¼ksek, yoÄŸuÅŸma ve mantar riski olabilir.';
                    }

                    if (message === '') { 
                        message = 'Sistem durumu iyi. Mikroalgler aktif olarak Ã§alÄ±ÅŸÄ±yor.';
                    }
                }
                statusMessageP.innerText = message;
            }

            // Firebase Entegrasyonu BaÅŸlangÄ±cÄ±
            let db; // Firestore veritabanÄ± Ã¶rneÄŸi
            let auth; // Firebase kimlik doÄŸrulama Ã¶rneÄŸi
            let userId; // KullanÄ±cÄ± kimliÄŸi
            
            // Canvas tarafÄ±ndan saÄŸlanan global deÄŸiÅŸkenleri kullanÄ±n
            const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
            const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

            // Firebase'i baÅŸlat
            try {
                const app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                auth = getAuth(app);

                // Kimlik doÄŸrulama durumu deÄŸiÅŸtiÄŸinde dinleyici
                onAuthStateChanged(auth, async (user) => {
                    if (!user) {
                        // KullanÄ±cÄ± oturum aÃ§madÄ±ysa anonim olarak oturum aÃ§mayÄ± dene
                        try {
                            if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                                await signInWithCustomToken(auth, __initial_auth_token);
                                console.log("Ã–zel token ile oturum aÃ§Ä±ldÄ±.");
                            } else {
                                await signInAnonymously(auth);
                                console.log("Anonim olarak oturum aÃ§Ä±ldÄ±.");
                            }
                            userId = auth.currentUser.uid; // Oturum aÃ§tÄ±ktan sonra userId'yi al
                            console.log("Firestore userId:", userId);
                            // SimÃ¼le edilmiÅŸ geÃ§miÅŸ verileri oluÅŸtur (sadece bir kez Ã§alÄ±ÅŸtÄ±rÄ±lmalÄ±)
                            await simulateHistoricalData();
                            startDataListening(); // Kimlik doÄŸrulama sonrasÄ± veri dinlemeyi baÅŸlat
                        } catch (error) {
                            console.error("Firebase Kimlik DoÄŸrulama HatasÄ±:", error);
                            statusMessageP.innerText = "Hata: Kimlik doÄŸrulama baÅŸarÄ±sÄ±z oldu. SensÃ¶r verileri yÃ¼klenemiyor.";
                        }
                    } else {
                        // Zaten oturum aÃ§mÄ±ÅŸsa
                        userId = user.uid;
                        console.log("KullanÄ±cÄ± zaten oturum aÃ§Ä±k:", userId);
                        // SimÃ¼le edilmiÅŸ geÃ§miÅŸ verileri oluÅŸtur (sadece bir kez Ã§alÄ±ÅŸtÄ±rÄ±lmalÄ±)
                        await simulateHistoricalData();
                        startDataListening(); // Kimlik doÄŸrulama sonrasÄ± veri dinlemeyi baÅŸlat
                    }
                });

            } catch (error) {
                console.error("Firebase BaÅŸlatma HatasÄ±:", error);
                statusMessageP.innerText = "Hata: Firebase baÅŸlatÄ±lamadÄ±. SensÃ¶r verileri yÃ¼klenemiyor.";
            }

            // SensÃ¶r Verisi GeÃ§miÅŸini Depolama ve Grafik AyarlarÄ±
            let sensorDataHistory = []; // CanlÄ± veri iÃ§in
            const MAX_DATA_POINTS = 30; // Grafikte gÃ¶sterilecek maksimum veri noktasÄ± sayÄ±sÄ±
            let historicalDataCache = {}; // GeÃ§miÅŸ veri Ã¶nbelleÄŸi

            // Grafik Nesneleri
            let co2Chart, mq135Chart, lightChart, tempHumidityChart;

            // Grafiklerin BaÅŸlatÄ±lmasÄ±
            function initializeCharts() {
                const defaultChartOptions = {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            type: 'category', 
                            title: {
                                display: true,
                                text: 'Zaman'
                            },
                             ticks: {
                                autoSkip: true,
                                maxTicksLimit: 10 
                            }
                        },
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'DeÄŸer'
                            }
                        }
                    },
                    plugins: {
                        legend: { display: true },
                        tooltip: { mode: 'index', intersect: false }
                    }
                };

                // CO2 GrafiÄŸi
                const co2Ctx = document.getElementById('co2ChartCanvas').getContext('2d');
                co2Chart = new Chart(co2Ctx, {
                    type: 'line',
                    data: { labels: [], datasets: [{ label: 'COâ‚‚ (ppm)', data: [], borderColor: '#4682B4', tension: 0.1, fill: false }] }, /* Steel Blue */
                    options: {
                        ...defaultChartOptions,
                        scales: { ...defaultChartOptions.scales, y: { ...defaultChartOptions.scales.y, title: { display: true, text: 'COâ‚‚ (ppm)' } } }
                    }
                });

                // MQ135 Hava Kalitesi GrafiÄŸi
                const mq135Ctx = document.getElementById('mq135ChartCanvas').getContext('2d');
                mq135Chart = new Chart(mq135Ctx, {
                    type: 'line',
                    data: { labels: [], datasets: [{ label: 'Hava Kalitesi (mV)', data: [], borderColor: '#2E8B57', tension: 0.1, fill: false }] }, /* Sea Green */
                    options: {
                        ...defaultChartOptions,
                        scales: { ...defaultChartOptions.scales, y: { ...defaultChartOptions.scales.y, title: { display: true, text: 'MQ135 (mV)' } } }
                    }
                });

                // IÅŸÄ±k Åiddeti GrafiÄŸi
                const lightCtx = document.getElementById('lightChartCanvas').getContext('2d');
                lightChart = new Chart(lightCtx, {
                    type: 'line',
                    data: { labels: [], datasets: [{ label: 'IÅŸÄ±k Åiddeti (lux)', data: [], borderColor: '#98D8C8', tension: 0.1, fill: false }] }, /* Light Teal */
                    options: {
                        ...defaultChartOptions,
                        scales: { ...defaultChartOptions.scales, y: { ...defaultChartOptions.scales.y, title: { display: true, text: 'IÅŸÄ±k (lux)' } } }
                    }
                });

                // SÄ±caklÄ±k ve Nem GrafiÄŸi
                const tempHumidityCtx = document.getElementById('tempHumidityChartCanvas').getContext('2d');
                tempHumidityChart = new Chart(tempHumidityCtx, {
                    type: 'line',
                    data: {
                        labels: [],
                        datasets: [
                            { label: 'SÄ±caklÄ±k (Â°C)', data: [], borderColor: '#4682B4', tension: 0.1, fill: false }, /* Steel Blue */
                            { label: 'Nem (%)', data: [], borderColor: '#2E8B57', tension: 0.1, fill: false } /* Sea Green */
                        ]
                    },
                    options: {
                        ...defaultChartOptions,
                        scales: { ...defaultChartOptions.scales, y: { ...defaultChartOptions.scales.y, title: { display: true, text: 'DeÄŸer' } } }
                    }
                });
            }

            // CanlÄ± sensÃ¶r verilerini dinleme
            function listenToLiveSensorData() {
                if (currentLiveListener) {
                    currentLiveListener(); // Ã–nceki dinleyiciyi kapat
                }
                const sensorDocRef = doc(db, `artifacts/${appId}/public/data/sensors/current_data`);

                currentLiveListener = onSnapshot(sensorDocRef, (docSnap) => {
                    if (docSnap.exists()) {
                        const data = docSnap.data();
                        const timestamp = data.timestamp && data.timestamp.toDate ? data.timestamp.toDate() : new Date();

                        const newDataPoint = {
                            timestamp: timestamp,
                            co2: data.co2,
                            mq135_value: data.mq135_value,
                            light_value: data.light_value,
                            temperature: data.temperature,
                            humidity: data.humidity
                        };
                        sensorDataHistory.push(newDataPoint);

                        if (sensorDataHistory.length > MAX_DATA_POINTS) {
                            sensorDataHistory.shift();
                        }
                        updateDisplay(sensorDataHistory); // CanlÄ± veriyi kullanarak ekranÄ± gÃ¼ncelle
                    } else {
                        console.log("CanlÄ± sensÃ¶r verisi bulunamadÄ± veya henÃ¼z veri gÃ¶nderilmedi!");
                        updateDisplay([]); // EkranÄ± sÄ±fÄ±rla
                        statusMessageP.innerText = "SensÃ¶r verisi bekleniyor... LÃ¼tfen Arduino'nuzdan veri gÃ¶ndermeyi baÅŸlatÄ±n.";
                    }
                }, (error) => {
                    console.error("Firestore'dan canlÄ± veri Ã§ekerken hata oluÅŸtu:", error);
                    statusMessageP.innerText = "Hata: CanlÄ± sensÃ¶r verileri yÃ¼klenemiyor. Konsolu kontrol edin.";
                });
            }

            // GeÃ§miÅŸ sensÃ¶r verilerini Ã§ekme
            async function fetchHistoricalData(regionId) {
                if (historicalDataCache[regionId]) {
                    return historicalDataCache[regionId];
                }
                try {
                    const q = query(
                        collection(db, `artifacts/${appId}/public/data/earthquake_regions/${regionId}/atmospheric_data`),
                        orderBy('timestamp'),
                        limit(MAX_DATA_POINTS)
                    );
                    const querySnapshot = await getDocs(q);
                    const data = [];
                    querySnapshot.forEach((doc) => {
                        const docData = doc.data();
                        data.push({
                            timestamp: docData.timestamp.toDate(),
                            co2: docData.co2,
                            mq135_value: docData.mq135_value,
                            light_value: docData.light_value,
                            temperature: docData.temperature,
                            humidity: docData.humidity
                        });
                    });
                    historicalDataCache[regionId] = data;
                    return data;
                } catch (error) {
                    console.error(`GeÃ§miÅŸ veri (${regionId}) Ã§ekerken hata oluÅŸtu:`, error);
                    showMessage(`Hata: ${regionId} iÃ§in geÃ§miÅŸ veri yÃ¼klenemedi.`);
                    return [];
                }
            }

            // SayÄ±sal ekranlarÄ± ve grafikleri gÃ¼ncelleyen ana fonksiyon
            function updateDisplay(dataPoints) {
                if (dataPoints.length > 0) {
                    const latestData = dataPoints[dataPoints.length - 1];
                    co2ValueSpan.innerText = `${latestData.co2 || '--'} ppm`;
                    mq135ValueSpan.innerText = `${latestData.mq135_value || '--'} mV`;
                    lightValueSpan.innerText = `${latestData.light_value || '--'} lux`;
                    tempValueSpan.innerText = `${latestData.temperature || '--'} Â°C`;
                    humidityValueSpan.innerText = `${latestData.humidity || '--'} %`;
                    updateStatusMessage(latestData.co2, latestData.mq135_value, latestData.light_value, latestData.temperature, latestData.humidity);
                } else {
                    co2ValueSpan.innerText = "-- ppm";
                    mq135ValueSpan.innerText = "-- mV";
                    lightValueSpan.innerText = "-- lux";
                    tempValueSpan.innerText = "-- Â°C";
                    humidityValueSpan.innerText = "-- %";
                    updateStatusMessage('--', '--', '--', '--', '--'); // Durum mesajÄ±nÄ± da sÄ±fÄ±rla
                }
                updateCharts(dataPoints);
            }

            // TÃ¼m grafikleri gÃ¼ncelleme fonksiyonu
            function updateCharts(dataPoints) {
                const labels = dataPoints.map(point => new Date(point.timestamp).toLocaleTimeString('tr-TR'));

                co2Chart.data.labels = labels;
                co2Chart.data.datasets[0].data = dataPoints.map(point => point.co2);
                co2Chart.update();

                mq135Chart.data.labels = labels;
                mq135Chart.data.datasets[0].data = dataPoints.map(point => point.mq135_value);
                mq135Chart.update();

                lightChart.data.labels = labels;
                lightChart.data.datasets[0].data = dataPoints.map(point => point.light_value);
                lightChart.update();

                tempHumidityChart.data.labels = labels;
                tempHumidityChart.data.datasets[0].data = dataPoints.map(point => point.temperature);
                tempHumidityChart.data.datasets[1].data = dataPoints.map(point => point.humidity);
                tempHumidityChart.update();
            }

            // Veri gÃ¶rÃ¼nÃ¼m modunu deÄŸiÅŸtiren fonksiyon
            async function switchDataViewMode() {
                currentViewMode = dataViewModeSelect.value;

                if (currentViewMode === 'live') {
                    regionSelectContainer.classList.add('hidden');
                    listenToLiveSensorData();
                    updateDisplay(sensorDataHistory); // Mevcut canlÄ± veriyi tekrar gÃ¶ster
                } else { // historical
                    if (currentLiveListener) {
                        currentLiveListener(); // CanlÄ± dinleyiciyi kapat
                        currentLiveListener = null;
                    }
                    regionSelectContainer.classList.remove('hidden');
                    // BÃ¶lge seÃ§ildiÄŸinde tetiklenecek fonksiyonu Ã§aÄŸÄ±r
                    if (regionSelect.value) {
                        const historicalData = await fetchHistoricalData(regionSelect.value);
                        updateDisplay(historicalData);
                    } else {
                        updateDisplay([]); // HenÃ¼z bÃ¶lge seÃ§ilmediyse ekranÄ± sÄ±fÄ±rla
                    }
                }
            }

            // `startDataListening` fonksiyonunu tanÄ±mla
            async function startDataListening() {
                // Bu fonksiyon, kimlik doÄŸrulama tamamlandÄ±ÄŸÄ±nda Ã§aÄŸrÄ±lÄ±r
                // ve baÅŸlangÄ±Ã§ta seÃ§ili olan gÃ¶rÃ¼nÃ¼me gÃ¶re veri dinlemeyi baÅŸlatÄ±r.
                await switchDataViewMode();
            }


            dataViewModeSelect.addEventListener('change', switchDataViewMode);
            regionSelect.addEventListener('change', async () => {
                const selectedRegionId = regionSelect.value;
                const historicalData = await fetchHistoricalData(selectedRegionId);
                updateDisplay(historicalData);
            });

            // BÃ¶lge seÃ§eneklerini doldurma
            const regions = {
                'kahramanmaras': 'KahramanmaraÅŸ',
                'hatay': 'Hatay',
                'gaziantep': 'Gaziantep',
                'adiyaman': 'AdÄ±yaman'
            };

            for (const id in regions) {
                const option = document.createElement('option');
                option.value = id;
                option.textContent = regions[id];
                regionSelect.appendChild(option);
            }

            // GeÃ§miÅŸ simÃ¼lasyon verilerini Firebase'e yÃ¼kle (YalnÄ±zca bir kez Ã§alÄ±ÅŸtÄ±rÄ±lmalÄ±)
            async function simulateHistoricalData() {
                // Her bÃ¶lge iÃ§in simÃ¼le edilmiÅŸ veri oluÅŸtur ve yÃ¼kle
                for (const regionId in regions) {
                    const collectionRef = collection(db, `artifacts/${appId}/public/data/earthquake_regions/${regionId}/atmospheric_data`);
                    
                    // Sadece veri yoksa yÃ¼kle
                    // `getDocs` doÄŸru bir ÅŸekilde import edildiÄŸi iÃ§in burada kullanÄ±labilir.
                    const querySnapshot = await getDocs(query(collectionRef, limit(1)));
                    if (querySnapshot.empty) {
                        console.log(`SimÃ¼le edilmiÅŸ geÃ§miÅŸ veri yÃ¼kleniyor: ${regions[regionId]}`);
                        for (let i = 0; i < MAX_DATA_POINTS; i++) {
                            const date = new Date(Date.now() - (MAX_DATA_POINTS - 1 - i) * 60 * 1000); // Her dakika bir veri noktasÄ±
                            const data = generateRandomSensorData(regionId);
                            await setDoc(doc(collectionRef), { // doc() ile otomatik ID oluÅŸtur
                                timestamp: date,
                                co2: data.co2,
                                mq135_value: data.mq135_value,
                                light_value: data.light_value,
                                temperature: data.temperature,
                                humidity: data.humidity
                            });
                        }
                        console.log(`${regions[regionId]} iÃ§in simÃ¼le edilmiÅŸ geÃ§miÅŸ veri yÃ¼klendi.`);
                    } else {
                        console.log(`${regions[regionId]} iÃ§in simÃ¼le edilmiÅŸ geÃ§miÅŸ veri zaten mevcut.`);
                    }
                }
            }

            // SimÃ¼le edilmiÅŸ sensÃ¶r verisi Ã¼reten fonksiyon
            function generateRandomSensorData(regionId) {
                let co2, mq135_value, light_value, temperature, humidity;

                switch (regionId) {
                    case 'kahramanmaras':
                        co2 = Math.floor(Math.random() * (1200 - 600 + 1)) + 600; // YÃ¼ksek CO2
                        mq135_value = Math.floor(Math.random() * (350 - 180 + 1)) + 180; // Orta-yÃ¼ksek hava kirliliÄŸi
                        light_value = Math.floor(Math.random() * (800 - 200 + 1)) + 200; // DeÄŸiÅŸken Ä±ÅŸÄ±k
                        temperature = (Math.random() * (28 - 18) + 18).toFixed(1); // IlÄ±man sÄ±caklÄ±k
                        humidity = (Math.random() * (70 - 45) + 45).toFixed(1); // Orta nem
                        break;
                    case 'hatay':
                        co2 = Math.floor(Math.random() * (1500 - 700 + 1)) + 700; // Ã‡ok yÃ¼ksek CO2
                        mq135_value = Math.floor(Math.random() * (450 - 250 + 1)) + 250; // YÃ¼ksek hava kirliliÄŸi
                        light_value = Math.floor(Math.random() * (900 - 300 + 1)) + 300; // YÃ¼ksek Ä±ÅŸÄ±k
                        temperature = (Math.random() * (32 - 20) + 20).toFixed(1); // YÃ¼ksek sÄ±caklÄ±k
                        humidity = (Math.random() * (80 - 50) + 50).toFixed(1); // YÃ¼ksek nem
                        break;
                    case 'gaziantep':
                        co2 = Math.floor(Math.random() * (1000 - 500 + 1)) + 500; // Orta CO2
                        mq135_value = Math.floor(Math.random() * (300 - 150 + 1)) + 150; // Orta hava kirliliÄŸi
                        light_value = Math.floor(Math.random() * (700 - 150 + 1)) + 150; // Orta Ä±ÅŸÄ±k
                        temperature = (Math.random() * (25 - 15) + 15).toFixed(1); // Daha serin sÄ±caklÄ±k
                        humidity = (Math.random() * (60 - 35) + 35).toFixed(1); // DÃ¼ÅŸÃ¼k-orta nem
                        break;
                    case 'adiyaman':
                        co2 = Math.floor(Math.random() * (1100 - 550 + 1)) + 550; // Orta-yÃ¼ksek CO2
                        mq135_value = Math.floor(Math.random() * (380 - 190 + 1)) + 190; // Orta-yÃ¼ksek hava kirliliÄŸi
                        light_value = Math.floor(Math.random() * (850 - 250 + 1)) + 250; // DeÄŸiÅŸken Ä±ÅŸÄ±k
                        temperature = (Math.random() * (30 - 17) + 17).toFixed(1); // IlÄ±man-yÃ¼ksek sÄ±caklÄ±k
                        humidity = (Math.random() * (75 - 40) + 40).toFixed(1); // Orta-yÃ¼ksek nem
                        break;
                    default: // CanlÄ± veri iÃ§in varsayÄ±lan
                        co2 = Math.floor(Math.random() * (700 - 350 + 1)) + 350;
                        mq135_value = Math.floor(Math.random() * (250 - 100 + 1)) + 100;
                        light_value = Math.floor(Math.random() * (600 - 100 + 1)) + 100;
                        temperature = (Math.random() * (27 - 20) + 20).toFixed(1);
                        humidity = (Math.random() * (65 - 30) + 30).toFixed(1);
                }
                return { co2, mq135_value, light_value, temperature, humidity };
            }

            // CSV Ä°ndirme Ä°ÅŸlevi
            const downloadCsvBtn = document.getElementById('download-csv-btn');
            if (downloadCsvBtn) {
                downloadCsvBtn.addEventListener('click', exportToCsv);
            }

            function exportToCsv() {
                let dataToExport = [];
                if (currentViewMode === 'live') {
                    dataToExport = sensorDataHistory;
                } else {
                    dataToExport = historicalDataCache[regionSelect.value] || [];
                }

                if (dataToExport.length === 0) {
                    showMessage("DÄ±ÅŸa aktarÄ±lacak veri bulunamadÄ±.");
                    return;
                }

                const headers = ["Timestamp", "CO2 (ppm)", "Hava Kalitesi (MQ135 mV)", "IÅŸÄ±k (lux)", "SÄ±caklÄ±k (Â°C)", "Nem (%)"];
                let csvContent = headers.join(",") + "\n";

                dataToExport.forEach(row => {
                    const timestamp = row.timestamp ? new Date(row.timestamp).toLocaleString('tr-TR') : '';
                    const values = [
                        row.co2,
                        row.mq135_value,
                        row.light_value,
                        row.temperature,
                        row.humidity
                    ];
                    csvContent += [timestamp, ...values].join(",") + "\n";
                });

                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                if (link.download !== undefined) {
                    const url = URL.createObjectURL(blob);
                    link.setAttribute('href', url);
                    link.setAttribute('download', `${currentViewMode === 'live' ? 'canli_veri' : regionSelect.value}_sensor_verileri.csv`);
                    link.style.visibility = 'hidden';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    URL.revokeObjectURL(url);
                    showMessage("Veriler CSV olarak dÄ±ÅŸa aktarÄ±ldÄ±!");
                } else {
                    showMessage("TarayÄ±cÄ±nÄ±z CSV dÄ±ÅŸa aktarÄ±mÄ± desteklemiyor.");
                }
            }

            // Sayfa yÃ¼klendiÄŸinde grafikleri baÅŸlat ve ilk veri dinlemeyi baÅŸlat
            initializeCharts();
            // Auth sonrasÄ± baÅŸlatma startDataListening() iÃ§inde zaten var.
        });
    </script>
</body>
</html>
